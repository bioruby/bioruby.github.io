<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>File: nexus.rb [BioRuby API documentation]</title>

  <link type="text/css" media="screen" href="../../../rdoc.css" rel="stylesheet" />

  <script src="../../../js/jquery.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../../../js/thickbox-compressed.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../../../js/quicksearch.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../../../js/darkfish.js" type="text/javascript"
    charset="utf-8"></script>
</head>

<body class="file file-popup">
  <div id="metadata">
    <dl>
      <dt class="modified-date">Last Modified</dt>
      <dd class="modified-date">2010-10-22 11:48:50 +0900</dd>

      
      <dt class="requires">Requires</dt>
      <dd class="requires">
        <ul>
        
          <li>bio/sequence</li>
        
          <li>bio/tree</li>
        
          <li>bio/db/newick</li>
        
        </ul>
      </dd>
      

      
    </dl>
  </div>

  <div id="documentation">
    
    <div class="description">
      <h2>Description</h2>
      
<h1>bio/db/nexus.rb - Nexus Standard phylogenetic tree parser / formatter</h1>
<table class="rdoc-list"><tr><td class="rdoc-term"><p>Copyright</p></td>
<td>
<p>Copyright (C) 2006        Christian M Zmasek &lt;cmzmasek@yahoo.com&gt;</p>
</td></tr><tr><td class="rdoc-term"><p>License</p></td>
<td>
<p>The Ruby License</p>
</td></tr></table>

<p>$Id: nexus.rb,v 1.3 2007/04/05 23:35:40 trevor Exp $</p>

<h2>Description</h2>

<p>This file contains classes that implement a parser for NEXUS formatted data
as well as objects to store, access, and write the parsed data.</p>

<p>The following five blocks: taxa, characters, distances, trees, data are
recognizable and parsable.</p>

<p>The parser can deal with (nested) comments (indicated by square brackets),
unless the comments are inside a command or data item (e.g.  “<a
href="http://comment">Dim</a>ensions” or inside a matrix).</p>

<p>Single or double quoted TaxLabels are processed as follows (by way of
example): “mus musculus” -&gt; mus_musculus</p>

<h2>USAGE</h2>

<pre>require 'bio/db/nexus'

# Create a new parser:
nexus = Bio::Nexus.new( nexus_data_as_string )

# Get first taxa block:   
taxa_block = nexus.get_taxa_blocks[ 0 ]
# Get number of taxa:
number_of_taxa = taxa_block.get_number_of_taxa.to_i
# Get name of first taxon:
first_taxon = taxa_block.get_taxa[ 0 ]

# Get first data block:   
data_block = nexus.get_data_blocks[ 0 ]
# Get first characters name:
seq_name = data_block.get_row_name( 0 )
# Get first characters row named &quot;taxon_2&quot; as Bio::Sequence sequence:
seq_tax_2 = data_block.get_sequences_by_name( &quot;taxon_2&quot; )[ 0 ]
# Get third characters row as Bio::Sequence sequence:
seq_2 = data_block.get_sequence( 2 )
# Get first characters row named &quot;taxon_3&quot; as String:   
string_tax_3 = data_block.get_characters_strings_by_name( &quot;taxon_3&quot; )
# Get name of first taxon:
taxon_0 = data_block.get_taxa[ 0 ]
# Get characters matrix as Bio::Nexus::NexusMatrix (names are in column 0)
characters_matrix = data_block.get_matrix

# Get first characters block (same methods as Nexus::DataBlock except
# it lacks get_taxa method):   
characters_block = nexus.get_characters_blocks[ 0 ]

# Get trees block(s):   
trees_block = nexus.get_trees_blocks[ 0 ]
# Get first tree named &quot;best&quot; as String:
string_fish = trees_block.get_tree_strings_by_name( &quot;best&quot; )[ 0 ]
# Get first tree named &quot;best&quot; as Bio::Db::Newick object:
tree_fish = trees_block.get_trees_by_name( &quot;best&quot; )[ 0 ]
# Get first tree as Bio::Db::Newick object:
tree_first = trees_block.get_tree( 0 )

# Get distances block(s):   
distances_blocks = nexus.get_distances_blocks
# Get matrix as Bio::Nexus::NexusMatrix object:
matrix = distances_blocks[ 0 ].get_matrix
# Get value (column 0 are names):
val = matrix.get_value( 1, 5 )

# Get blocks for which no class exists (private blocks):
private_blocks = nexus.get_blocks_by_name( &quot;my_block&quot; )
# Get first block names &quot;my_block&quot;:
my_block_0 = private_blocks[ 0 ]
# Get first token in first block names &quot;my_block&quot;:
first_token = my_block_0.get_tokens[ 0 ]</pre>

<h2>References</h2>
<ul><li>
<p>Maddison DR, Swofford DL, Maddison WP (1997). NEXUS: an extensible file
format for systematic information.  Syst Biol. 1997 46(4):590-621.</p>
</li></ul>

    </div>
    
  </div>
</body>
</html>

