<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Bio::Fastq - BioRuby API documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="../Object.html">Object</a>
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-add_header_line">#add_header_line</a>
    
    <li ><a href="#method-i-add_line">#add_line</a>
    
    <li ><a href="#method-i-entry_id">#entry_id</a>
    
    <li ><a href="#method-i-error_probabilities">#error_probabilities</a>
    
    <li ><a href="#method-i-format">#format</a>
    
    <li ><a href="#method-i-format-3D">#format=</a>
    
    <li ><a href="#method-i-mask">#mask</a>
    
    <li ><a href="#method-i-nalen">#nalen</a>
    
    <li ><a href="#method-i-naseq">#naseq</a>
    
    <li ><a href="#method-i-qualities">#qualities</a>
    
    <li ><a href="#method-i-quality_score_type">#quality_score_type</a>
    
    <li ><a href="#method-i-quality_scores">#quality_scores</a>
    
    <li ><a href="#method-i-seq">#seq</a>
    
    <li ><a href="#method-i-to_biosequence">#to_biosequence</a>
    
    <li ><a href="#method-i-to_s">#to_s</a>
    
    <li ><a href="#method-i-validate_format">#validate_format</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Bio::Fastq">
  <h1 id="class-Bio::Fastq" class="class">
    class Bio::Fastq
  </h1>

  <section class="description">
    
<p><a href="Fastq.html">Bio::Fastq</a> is a parser for FASTQ format.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="DefaultFormatName">DefaultFormatName
        
        <dd><p>Default format name</p>
        
      
        <dt id="FLATFILE_SPLITTER">FLATFILE_SPLITTER
        
        <dd><p>Splitter for <a href="FlatFile.html">Bio::FlatFile</a></p>
        
      
        <dt id="FormatNames">FormatNames
        
        <dd><p>Available format names.</p>
        
      
        <dt id="Formats">Formats
        
        <dd><p>Available format name symbols.</p>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-definition" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">definition</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>definition; ID line (begins with @)</p>
        
        </div>
      </div>
      
      <div id="attribute-i-entry_overrun" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">entry_overrun</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p><a href="Fastq.html#attribute-i-entry_overrun">#entry_overrun</a></p>
        
        </div>
      </div>
      
      <div id="attribute-i-header" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">header</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>misc lines before the entry (String or nil)</p>
        
        </div>
      </div>
      
      <div id="attribute-i-quality_string" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">quality_string</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>quality as a string</p>
        
        </div>
      </div>
      
      <div id="attribute-i-sequence_string" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">sequence_string</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>raw sequence data as a <a href="../String.html">String</a> object</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(str = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates a new <a href="Fastq.html">Fastq</a> object from formatted text
string.</p>

<p>The format of quality scores should be specified later by using
<code>format=</code> method.</p>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p><em>str</em>: Formatted string (String)</p>
</li></ul>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 383</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">str</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">str</span>
  <span class="ruby-identifier">sc</span> = <span class="ruby-constant">StringScanner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-keyword">while</span> <span class="ruby-operator">!</span><span class="ruby-identifier">sc</span>.<span class="ruby-identifier">eos?</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">line</span> = <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/.*(?:\n|\r|\r\n)?/</span>)
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">add_header_line</span>(<span class="ruby-identifier">line</span>) <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">unscan</span>
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">while</span> <span class="ruby-operator">!</span><span class="ruby-identifier">sc</span>.<span class="ruby-identifier">eos?</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">line</span> = <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/.*(?:\n|\r|\r\n)?/</span>)
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">add_line</span>(<span class="ruby-identifier">line</span>) <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">unscan</span>
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@entry_overrun</span> = <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">rest</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-add_header_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_header_line</span><span
            class="method-args">(line)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds a header line if the header data is not yet given and the given line
is suitable for header. Returns self if adding header line is succeeded.
Otherwise, returns false (the line is not added).</p>
          
          

          
          <div class="method-source-code" id="add_header_line-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 324</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_header_line</span>(<span class="ruby-identifier">line</span>)
  <span class="ruby-ivar">@header</span> <span class="ruby-operator">||=</span> <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;@&quot;</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@header</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">line</span>
    <span class="ruby-keyword">self</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_line</span><span
            class="method-args">(line)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds a line to the entry if the given line is regarded as a part of the
current entry.</p>
          
          

          
          <div class="method-source-code" id="add_line-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 339</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_line</span>(<span class="ruby-identifier">line</span>)
  <span class="ruby-identifier">line</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">chomp</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword">defined?</span> <span class="ruby-ivar">@definition</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>, <span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;@&quot;</span> <span class="ruby-keyword">then</span>
      <span class="ruby-ivar">@definition</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@definition</span> = <span class="ruby-identifier">line</span>
      <span class="ruby-ivar">@parse_errors</span> <span class="ruby-operator">||=</span> []
      <span class="ruby-ivar">@parse_errors</span>.<span class="ruby-identifier">push</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">No_atmark</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span> <span class="ruby-ivar">@definition2</span> <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@quality_string</span> <span class="ruby-operator">||=</span> <span class="ruby-string">&#39;&#39;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>, <span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;@&quot;</span> <span class="ruby-keyword">and</span>
        <span class="ruby-ivar">@quality_string</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@sequence_string</span>.<span class="ruby-identifier">size</span> <span class="ruby-keyword">then</span>
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@quality_string</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">line</span>
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@sequence_string</span> <span class="ruby-operator">||=</span> <span class="ruby-string">&#39;&#39;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>, <span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;+&#39;</span> <span class="ruby-keyword">then</span>
      <span class="ruby-ivar">@definition2</span> = <span class="ruby-identifier">line</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@sequence_string</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">line</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Bug: should not reach here!&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-entry_id" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">entry_id</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Identifier of the entry. Normally, the first word of the ID line.</p>
          
          

          
          <div class="method-source-code" id="entry_id-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 446</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">entry_id</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span> <span class="ruby-ivar">@entry_id</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">eid</span> = <span class="ruby-ivar">@definition</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">/\s+/</span>)[<span class="ruby-value">0</span>] <span class="ruby-operator">||</span> <span class="ruby-ivar">@definition</span>
    <span class="ruby-ivar">@entry_id</span> = <span class="ruby-identifier">eid</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@entry_id</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-error_probabilities" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">error_probabilities</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Estimated probability of error for each base.</p>
<hr>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>(Array containing Float) error probability values</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="error_probabilities-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 529</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">error_probabilities</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span> <span class="ruby-ivar">@error_probabilities</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">format</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">DefaultFormatName</span>
    <span class="ruby-identifier">a</span> = <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">q2p</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">quality_scores</span>)
    <span class="ruby-ivar">@error_probabilities</span> = <span class="ruby-identifier">a</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@error_probabilities</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-format" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">format</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Format name. One of “fastq-sanger”, “fastq-solexa”, “fastq-illumina”, or
nil (when not specified).</p>
<hr>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>(String or nil) format name</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="format-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 497</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">format</span>
  ((<span class="ruby-keyword">defined?</span> <span class="ruby-ivar">@format</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@format</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-format-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">format=</span><span
            class="method-args">(name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Specify the format. If the format is not found, raises RuntimeError.</p>

<p>Available formats are:</p>

<pre class="ruby"><span class="ruby-string">&quot;fastq-sanger&quot;</span> <span class="ruby-keyword">or</span> :<span class="ruby-identifier">fastq_sanger</span>
<span class="ruby-string">&quot;fastq-solexa&quot;</span> <span class="ruby-keyword">or</span> :<span class="ruby-identifier">fastq_solexa</span>
<span class="ruby-string">&quot;fastq-illumina&quot;</span> <span class="ruby-keyword">or</span> :<span class="ruby-identifier">fastq_illumina</span>
</pre>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p>(required) <em>name</em>: format name (String or Symbol).</p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>(String) format name</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="format-3D-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 476</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">format=</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">f</span> = <span class="ruby-constant">FormatNames</span>[<span class="ruby-identifier">name</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">Formats</span>[<span class="ruby-identifier">name</span>]
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">f</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">reset_state</span>
      <span class="ruby-ivar">@format</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">instance</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">format</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;unknown format&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">reset_state</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-mask" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">mask</span><span
            class="method-args">(threshold, mask_char = 'n')</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Masks low quality sequence regions. For each sequence position, if the
quality score is smaller than the threshold, the sequence in the position
is replaced with <em>mask_char</em>.</p>

<p>Note: This method does not care quality_score_type.</p>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p>(required) <em>threshold</em> : (Numeric) threshold</p>
</li><li>
<p>(optional) <em>mask_char</em> : (String) character used for masking</p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p><a href="Sequence.html">Bio::Sequence</a> object</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="mask-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 668</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">mask</span>(<span class="ruby-identifier">threshold</span>, <span class="ruby-identifier">mask_char</span> = <span class="ruby-string">&#39;n&#39;</span>)
  <span class="ruby-identifier">to_biosequence</span>.<span class="ruby-identifier">mask_with_quality_score</span>(<span class="ruby-identifier">threshold</span>, <span class="ruby-identifier">mask_char</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-nalen" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">nalen</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>length of naseq</p>
          
          

          
          <div class="method-source-code" id="nalen-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 433</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">nalen</span>
  <span class="ruby-identifier">naseq</span>.<span class="ruby-identifier">length</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-naseq" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">naseq</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>returns <a href="Sequence/NA.html">Bio::Sequence::NA</a></p>
          
          

          
          <div class="method-source-code" id="naseq-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 425</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">naseq</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span> <span class="ruby-ivar">@naseq</span> <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@naseq</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Sequence</span><span class="ruby-operator">::</span><span class="ruby-constant">NA</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@sequence_string</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@naseq</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-qualities" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">qualities</span><span
            class="method-args">()</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Fastq.html#method-i-quality_scores">quality_scores</a>
        </div>
        
      </div>

    
      <div id="method-i-quality_score_type" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">quality_score_type</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The meaning of the quality scores. It may be one of :phred, :solexa, or
nil.</p>
          
          

          
          <div class="method-source-code" id="quality_score_type-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 504</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">quality_score_type</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">format</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">DefaultFormatName</span>
  <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">quality_score_type</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-quality_scores" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">quality_scores</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Quality score for each base. For “fastq-sanger” or “fastq-illumina”, it is
PHRED score. For “fastq-solexa”, it is Solexa score.</p>
<hr>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>(Array containing Integer) quality score values</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="quality_scores-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 515</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">quality_scores</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span> <span class="ruby-ivar">@quality_scores</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">format</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">DefaultFormatName</span>
    <span class="ruby-identifier">s</span> = <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">str2scores</span>(<span class="ruby-ivar">@quality_string</span>)
    <span class="ruby-ivar">@quality_scores</span> = <span class="ruby-identifier">s</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@quality_scores</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Fastq.html#method-i-qualities">qualities</a>
        </div>
        

        
      </div>

    
      <div id="method-i-seq" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">seq</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>returns Bio::Sequence::Generic</p>
          
          

          
          <div class="method-source-code" id="seq-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 438</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">seq</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span> <span class="ruby-ivar">@seq</span> <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@seq</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Sequence</span><span class="ruby-operator">::</span><span class="ruby-constant">Generic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@sequence_string</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@seq</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-to_biosequence" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_biosequence</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns sequence as a <a href="Sequence.html">Bio::Sequence</a> object.</p>

<p>Note: If you modify the returned <a href="Sequence.html">Bio::Sequence</a>
object, the sequence or definition in this <a href="Fastq.html">Fastq</a>
object might also be changed (but not always be changed) because of
efficiency.</p>
          
          

          
          <div class="method-source-code" id="to_biosequence-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 653</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_biosequence</span>
  <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Sequence</span>.<span class="ruby-identifier">adapter</span>(<span class="ruby-keyword">self</span>, <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Sequence</span><span class="ruby-operator">::</span><span class="ruby-constant">Adapter</span><span class="ruby-operator">::</span><span class="ruby-constant">Fastq</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-to_s" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_s</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns <a href="Fastq.html">Fastq</a> formatted string constructed from
instance variables. The string will always be consisted of four lines
without wrapping of the sequence and quality string, and the third-line is
always only contains “+”. This may be different from initial entry.</p>

<p>Note that use of the method may be inefficient and may lose performance
because new string object is created every time it is called. For showing
an entry as-is, consider using <a
href="FlatFile.html#method-i-entry_raw">Bio::FlatFile#entry_raw</a>. For
output with various options, use <a
href="Sequence/Format.html#method-i-output">Bio::Sequence::Format#output</a>(:fastq).</p>
          
          

          
          <div class="method-source-code" id="to_s-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 420</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_s</span>
  <span class="ruby-node">&quot;@#{@definition}\n#{@sequence_string}\n+\n#{@quality_string}\n&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-validate_format" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">validate_format</span><span
            class="method-args">(errors = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Format validation.</p>

<p>If an array is given as the argument, when errors are found, error objects
are pushed to the array. Currently, following errors may be added to the
array. (All errors are under the <a href="Fastq.html">Bio::Fastq</a>
namespace, for example, <a
href="Fastq/Error/Diff_ids.html">Bio::Fastq::Error::Diff_ids</a>).</p>

<p><a href="Fastq/Error/Diff_ids.html">Error::Diff_ids</a>   – the identifier
in the two lines are different <a
href="Fastq/Error/Long_qual.html">Error::Long_qual</a>  – length of quality
is longer than the sequence <a
href="Fastq/Error/Short_qual.html">Error::Short_qual</a> – length of
quality is shorter than the sequence <a
href="Fastq/Error/No_qual.html">Error::No_qual</a>    – no quality
characters found <a href="Fastq/Error/No_seq.html">Error::No_seq</a>     –
no sequence found <a href="Fastq/Error/Qual_char.html">Error::Qual_char</a>
– invalid character in the quality <a
href="Fastq/Error/Seq_char.html">Error::Seq_char</a>   – invalid character
in the sequence <a href="Fastq/Error/Qual_range.html">Error::Qual_range</a>
– quality score value out of range <a
href="Fastq/Error/No_ids.html">Error::No_ids</a>     – sequence identifier
not found <a href="Fastq/Error/No_atmark.html">Error::No_atmark</a>  – the
first identifier does not begin with “@” <a
href="Fastq/Error/Skipped_unformatted_lines.html">Error::Skipped_unformatted_lines</a>
– the parser skipped unformatted lines that could not be recognized as
FASTQ format</p>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p>(optional) <em>errors</em>: (Array or nil) an array for pushing error
messages. The array should be empty.</p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>true:no error, false: containing error.</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="validate_format-source">
            <pre><span class="ruby-comment"># File lib/bio/db/fastq.rb, line 562</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">validate_format</span>(<span class="ruby-identifier">errors</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">err</span> = []

  <span class="ruby-comment"># if header exists, the format might be broken.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span> <span class="ruby-ivar">@header</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@header</span> <span class="ruby-keyword">and</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@header</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">err</span>.<span class="ruby-identifier">push</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">Skipped_unformatted_lines</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># if parse errors exist, adding them</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span> <span class="ruby-ivar">@parse_errors</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@parse_errors</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">err</span>.<span class="ruby-identifier">concat</span> <span class="ruby-ivar">@parse_errors</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># check if identifier exists, and identifier matches</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@definition</span>) <span class="ruby-keyword">or</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@definition</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">err</span>.<span class="ruby-identifier">push</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">No_ids</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@definition2</span>) <span class="ruby-keyword">and</span>
      <span class="ruby-operator">!</span><span class="ruby-ivar">@definition2</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword">and</span>
      <span class="ruby-ivar">@definition</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@definition2</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">err</span>.<span class="ruby-identifier">push</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">Diff_ids</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># check if sequence exists</span>
  <span class="ruby-identifier">has_seq</span>  = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@sequence_string</span>) <span class="ruby-keyword">or</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@sequence_string</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">err</span>.<span class="ruby-identifier">push</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">No_seq</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-identifier">has_seq</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># check if quality exists</span>
  <span class="ruby-identifier">has_qual</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@quality_string</span>) <span class="ruby-keyword">or</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@quality_string</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">err</span>.<span class="ruby-identifier">push</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">No_qual</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-identifier">has_qual</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># sequence and quality length check</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">has_seq</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">has_qual</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">slen</span> = <span class="ruby-ivar">@sequence_string</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-identifier">qlen</span> = <span class="ruby-ivar">@quality_string</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">slen</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">qlen</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">err</span>.<span class="ruby-identifier">push</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">Short_qual</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">qlen</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">slen</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">err</span>.<span class="ruby-identifier">push</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">Long_qual</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># sequence character check</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">has_seq</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">sc</span> = <span class="ruby-constant">StringScanner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@sequence_string</span>)
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">scan_until</span>(<span class="ruby-regexp">/[ \x00-\x1f\x7f-\xff]/n</span>)
      <span class="ruby-identifier">err</span>.<span class="ruby-identifier">push</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">Seq_char</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">sc</span>.<span class="ruby-identifier">pos</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">matched_size</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># sequence character check</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">has_qual</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">fmt</span> = <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@format</span>) <span class="ruby-keyword">and</span> <span class="ruby-ivar">@format</span> <span class="ruby-keyword">then</span>
            <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">name</span>
          <span class="ruby-keyword">else</span>
            <span class="ruby-keyword">nil</span>
          <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">re</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">fmt</span>
         <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;fastq-sanger&#39;</span>
           <span class="ruby-regexp">/[^\x21-\x7e]/n</span>
         <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;fastq-solexa&#39;</span>
           <span class="ruby-regexp">/[^\x3b-\x7e]/n</span>
         <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;fastq-illumina&#39;</span>
           <span class="ruby-regexp">/[^\x40-\x7e]/n</span>
         <span class="ruby-keyword">else</span>
           <span class="ruby-regexp">/[ \x00-\x1f\x7f-\xff]/n</span>
         <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">sc</span> = <span class="ruby-constant">StringScanner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@quality_string</span>)
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">scan_until</span>(<span class="ruby-identifier">re</span>)
      <span class="ruby-identifier">err</span>.<span class="ruby-identifier">push</span> <span class="ruby-constant">Error</span><span class="ruby-operator">::</span><span class="ruby-constant">Qual_char</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">sc</span>.<span class="ruby-identifier">pos</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">sc</span>.<span class="ruby-identifier">matched_size</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># if &quot;errors&quot; is given, set errors</span>
  <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">err</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">errors</span>
  <span class="ruby-comment"># returns true if no error; otherwise, returns false</span>
  <span class="ruby-identifier">err</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.0.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

