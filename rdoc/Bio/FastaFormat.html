<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Bio::FastaFormat - BioRuby API documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/navigation.js" defer></script>
<script src="../js/search.js" defer></script>
<script src="../js/search_index.js" defer></script>
<script src="../js/searcher.js" defer></script>
<script src="../js/darkfish.js" defer></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">




<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#class-Bio::FastaFormat-label-Examples">Examples</a>
    <li><a href="#class-Bio::FastaFormat-label-Methods+related+to+the+name+of+the+sequence">Methods related to the name of the sequence</a>
    <li><a href="#class-Bio::FastaFormat-label-Methods+related+to+the+actual+sequence">Methods related to the actual sequence</a>
    <li><a href="#class-Bio::FastaFormat-label-A+less+structured+fasta+entry">A less structured fasta entry</a>
    <li><a href="#class-Bio::FastaFormat-label-References">References</a>
  </ul>
</div>


  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="DB.html">Bio::DB</a>
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-aalen">#aalen</a>
    
    <li ><a href="#method-i-aaseq">#aaseq</a>
    
    <li ><a href="#method-i-acc_version">#acc_version</a>
    
    <li ><a href="#method-i-accession">#accession</a>
    
    <li ><a href="#method-i-accessions">#accessions</a>
    
    <li ><a href="#method-i-blast">#blast</a>
    
    <li ><a href="#method-i-comment">#comment</a>
    
    <li ><a href="#method-i-entry">#entry</a>
    
    <li ><a href="#method-i-entry_id">#entry_id</a>
    
    <li ><a href="#method-i-fasta">#fasta</a>
    
    <li ><a href="#method-i-first_name">#first_name</a>
    
    <li ><a href="#method-i-gi">#gi</a>
    
    <li ><a href="#method-i-identifiers">#identifiers</a>
    
    <li ><a href="#method-i-length">#length</a>
    
    <li ><a href="#method-i-locus">#locus</a>
    
    <li ><a href="#method-i-nalen">#nalen</a>
    
    <li ><a href="#method-i-naseq">#naseq</a>
    
    <li ><a href="#method-i-query">#query</a>
    
    <li ><a href="#method-i-seq">#seq</a>
    
    <li ><a href="#method-i-to_biosequence">#to_biosequence</a>
    
    <li ><a href="#method-i-to_s">#to_s</a>
    
    <li ><a href="#method-i-to_seq">#to_seq</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Bio::FastaFormat">
  <h1 id="class-Bio::FastaFormat" class="class">
    class Bio::FastaFormat
  </h1>

  <section class="description">
    
<p>Treats a FASTA formatted entry, such as:</p>

<pre>&gt;id and/or some comments                    &lt;== definition line
ATGCATGCATGCATGCATGCATGCATGCATGCATGC        &lt;== sequence lines
ATGCATGCATGCATGCATGCATGCATGCATGCATGC
ATGCATGCATGC</pre>

<p>The precedent &#39;&gt;&#39; can be omitted and the trailing &#39;&gt;&#39; will be removed automatically.</p>

<h3 id="class-Bio::FastaFormat-label-Examples">Examples<span><a href="#class-Bio::FastaFormat-label-Examples">&para;</a> <a href="#top">&uarr;</a></span></h3>

<pre class="ruby"><span class="ruby-identifier">fasta_string</span> = <span class="ruby-identifier">&lt;&lt;END_OF_STRING</span>
<span class="ruby-value">&gt;gi|398365175|ref|NP_009718.3| Cdc28p [Saccharomyces cerevisiae S288c]
MSGELANYKRLEKVGEGTYGVVYKALDLRPGQGQRVVALKKIRLESEDEGVPSTAIREISLLKELKDDNI
VRLYDIVHSDAHKLYLVFEFLDLDLKRYMEGIPKDQPLGADIVKKFMMQLCKGIAYCHSHRILHRDLKPQ
NLLINKDGNLKLGDFGLARAFGVPLRAYTHEIVTLWYRAPEVLLGGKQYSTGVDTWSIGCIFAEMCNRKP
IFSGDSEIDQIFKIFRVLGTPNEAIWPDIVYLPDFKPSFPQWRRKDLSQVVPSLDPRGIDLLDKLLAYDP
INRISARRAAIHPYFQES
</span><span class="ruby-identifier">END_OF_STRING</span>

<span class="ruby-identifier">f</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">FastaFormat</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">fasta_string</span>)

<span class="ruby-identifier">f</span>.<span class="ruby-identifier">entry</span> <span class="ruby-comment">#=&gt; &quot;&gt;gi|398365175|ref|NP_009718.3| Cdc28p [Saccharomyces cerevisiae S288c]\n&quot;+</span>
<span class="ruby-comment"># MSGELANYKRLEKVGEGTYGVVYKALDLRPGQGQRVVALKKIRLESEDEGVPSTAIREISLLKELKDDNI\n&quot;+</span>
<span class="ruby-comment"># VRLYDIVHSDAHKLYLVFEFLDLDLKRYMEGIPKDQPLGADIVKKFMMQLCKGIAYCHSHRILHRDLKPQ\n&quot;+</span>
<span class="ruby-comment"># NLLINKDGNLKLGDFGLARAFGVPLRAYTHEIVTLWYRAPEVLLGGKQYSTGVDTWSIGCIFAEMCNRKP\n&quot;+</span>
<span class="ruby-comment"># IFSGDSEIDQIFKIFRVLGTPNEAIWPDIVYLPDFKPSFPQWRRKDLSQVVPSLDPRGIDLLDKLLAYDP\n&quot;+</span>
<span class="ruby-comment"># INRISARRAAIHPYFQES&quot;</span>
</pre>

<h4 id="class-Bio::FastaFormat-label-Methods+related+to+the+name+of+the+sequence">Methods related to the name of the sequence<span><a href="#class-Bio::FastaFormat-label-Methods+related+to+the+name+of+the+sequence">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>A larger range of methods for dealing with <a href="Fasta.html"><code>Fasta</code></a> definition lines can be found in <a href="FastaDefline.html"><code>FastaDefline</code></a>, accessed through the <a href="FastaFormat.html#method-i-identifiers"><code>FastaFormat#identifiers</code></a> method.</p>

<pre class="ruby"><span class="ruby-identifier">f</span>.<span class="ruby-identifier">entry_id</span> <span class="ruby-comment">#=&gt; &quot;gi|398365175&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">first_name</span> <span class="ruby-comment">#=&gt; &quot;gi|398365175|ref|NP_009718.3|&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">definition</span> <span class="ruby-comment">#=&gt; &quot;gi|398365175|ref|NP_009718.3| Cdc28p [Saccharomyces cerevisiae S288c]&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">identifiers</span> <span class="ruby-comment">#=&gt; Bio::FastaDefline instance</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">accession</span> <span class="ruby-comment">#=&gt; &quot;NP_009718&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">accessions</span> <span class="ruby-comment">#=&gt; [&quot;NP_009718&quot;]</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">acc_version</span> <span class="ruby-comment">#=&gt; &quot;NP_009718.3&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">comment</span> <span class="ruby-comment">#=&gt; nil</span>
</pre>

<h4 id="class-Bio::FastaFormat-label-Methods+related+to+the+actual+sequence">Methods related to the actual sequence<span><a href="#class-Bio::FastaFormat-label-Methods+related+to+the+actual+sequence">&para;</a> <a href="#top">&uarr;</a></span></h4>

<pre class="ruby"><span class="ruby-identifier">f</span>.<span class="ruby-identifier">seq</span> <span class="ruby-comment">#=&gt; &quot;MSGELANYKRLEKVGEGTYGVVYKALDLRPGQGQRVVALKKIRLESEDEGVPSTAIREISLLKELKDDNIVRLYDIVHSDAHKLYLVFEFLDLDLKRYMEGIPKDQPLGADIVKKFMMQLCKGIAYCHSHRILHRDLKPQNLLINKDGNLKLGDFGLARAFGVPLRAYTHEIVTLWYRAPEVLLGGKQYSTGVDTWSIGCIFAEMCNRKPIFSGDSEIDQIFKIFRVLGTPNEAIWPDIVYLPDFKPSFPQWRRKDLSQVVPSLDPRGIDLLDKLLAYDPINRISARRAAIHPYFQES&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">data</span> <span class="ruby-comment">#=&gt; &quot;\nMSGELANYKRLEKVGEGTYGVVYKALDLRPGQGQRVVALKKIRLESEDEGVPSTAIREISLLKELKDDNI\nVRLYDIVHSDAHKLYLVFEFLDLDLKRYMEGIPKDQPLGADIVKKFMMQLCKGIAYCHSHRILHRDLKPQ\nNLLINKDGNLKLGDFGLARAFGVPLRAYTHEIVTLWYRAPEVLLGGKQYSTGVDTWSIGCIFAEMCNRKP\nIFSGDSEIDQIFKIFRVLGTPNEAIWPDIVYLPDFKPSFPQWRRKDLSQVVPSLDPRGIDLLDKLLAYDP\nINRISARRAAIHPYFQES\n&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">length</span> <span class="ruby-comment">#=&gt; 298</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">aaseq</span> <span class="ruby-comment">#=&gt; &quot;MSGELANYKRLEKVGEGTYGVVYKALDLRPGQGQRVVALKKIRLESEDEGVPSTAIREISLLKELKDDNIVRLYDIVHSDAHKLYLVFEFLDLDLKRYMEGIPKDQPLGADIVKKFMMQLCKGIAYCHSHRILHRDLKPQNLLINKDGNLKLGDFGLARAFGVPLRAYTHEIVTLWYRAPEVLLGGKQYSTGVDTWSIGCIFAEMCNRKPIFSGDSEIDQIFKIFRVLGTPNEAIWPDIVYLPDFKPSFPQWRRKDLSQVVPSLDPRGIDLLDKLLAYDPINRISARRAAIHPYFQES&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">aaseq</span>.<span class="ruby-identifier">composition</span> <span class="ruby-comment">#=&gt; {&quot;M&quot;=&gt;5, &quot;S&quot;=&gt;15, &quot;G&quot;=&gt;21, &quot;E&quot;=&gt;16, &quot;L&quot;=&gt;36, &quot;A&quot;=&gt;17, &quot;N&quot;=&gt;8, &quot;Y&quot;=&gt;13, &quot;K&quot;=&gt;22, &quot;R&quot;=&gt;20, &quot;V&quot;=&gt;18, &quot;T&quot;=&gt;7, &quot;D&quot;=&gt;23, &quot;P&quot;=&gt;17, &quot;Q&quot;=&gt;10, &quot;I&quot;=&gt;23, &quot;H&quot;=&gt;7, &quot;F&quot;=&gt;12, &quot;C&quot;=&gt;4, &quot;W&quot;=&gt;4}</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">aalen</span> <span class="ruby-comment">#=&gt; 298</span>
</pre>

<h3 id="class-Bio::FastaFormat-label-A+less+structured+fasta+entry">A less structured fasta entry<span><a href="#class-Bio::FastaFormat-label-A+less+structured+fasta+entry">&para;</a> <a href="#top">&uarr;</a></span></h3>

<pre class="ruby"><span class="ruby-identifier">f</span>.<span class="ruby-identifier">entry</span> <span class="ruby-comment">#=&gt; &quot;&gt;abc 123 456\nASDF&quot;</span>

<span class="ruby-identifier">f</span>.<span class="ruby-identifier">entry_id</span> <span class="ruby-comment">#=&gt; &quot;abc&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">first_name</span> <span class="ruby-comment">#=&gt; &quot;abc&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">definition</span> <span class="ruby-comment">#=&gt; &quot;abc 123 456&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">comment</span> <span class="ruby-comment">#=&gt; nil</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">accession</span> <span class="ruby-comment">#=&gt; nil</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">accessions</span> <span class="ruby-comment">#=&gt; []</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">acc_version</span> <span class="ruby-comment">#=&gt; nil</span>

<span class="ruby-identifier">f</span>.<span class="ruby-identifier">seq</span> <span class="ruby-comment">#=&gt; &quot;ASDF&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">data</span> <span class="ruby-comment">#=&gt; &quot;\nASDF\n&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">length</span> <span class="ruby-comment">#=&gt; 4</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">aaseq</span> <span class="ruby-comment">#=&gt; &quot;ASDF&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">aaseq</span>.<span class="ruby-identifier">composition</span> <span class="ruby-comment">#=&gt; {&quot;A&quot;=&gt;1, &quot;S&quot;=&gt;1, &quot;D&quot;=&gt;1, &quot;F&quot;=&gt;1}</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">aalen</span> <span class="ruby-comment">#=&gt; 4</span>
</pre>

<h3 id="class-Bio::FastaFormat-label-References"><a href="References.html"><code>References</code></a><span><a href="#class-Bio::FastaFormat-label-References">&para;</a> <a href="#top">&uarr;</a></span></h3>
<ul><li>
<p>FASTA format (WikiPedia)  <a href="http://en.wikipedia.org/wiki/FASTA_format">en.wikipedia.org/wiki/FASTA_format</a></p>
</li></ul>

  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="DELIMITER">DELIMITER
        
        <dd><p>Entry delimiter in flatfile text.</p>
        
      
        <dt id="DELIMITER_OVERRUN">DELIMITER_OVERRUN
        
        <dd><p>(Integer) excess read size included in <a href="FastaFormat.html#DELIMITER"><code>DELIMITER</code></a>.</p>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-data" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">data</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>The seuqnce lines in text.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-definition" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">definition</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>The comment line of the FASTA formatted data.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-entry_overrun" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">entry_overrun</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(str)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Stores the comment and sequence information from one entry of the FASTA format string.  If the argument contains more than one entry, only the first entry is used.</p>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">133</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">str</span>)
<span class="line-num">134</span>   <span class="ruby-ivar">@definition</span> = <span class="ruby-identifier">str</span>[<span class="ruby-regexp">/.*/</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/^&gt;/</span>, <span class="ruby-string">&#39;&#39;</span>).<span class="ruby-identifier">strip</span>       <span class="ruby-comment"># 1st line</span>
<span class="line-num">135</span>   <span class="ruby-ivar">@data</span> = <span class="ruby-identifier">str</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/.*/</span>, <span class="ruby-string">&#39;&#39;</span>)                         <span class="ruby-comment"># rests</span>
<span class="line-num">136</span>   <span class="ruby-ivar">@data</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp">/^&gt;.*/m</span>, <span class="ruby-string">&#39;&#39;</span>)   <span class="ruby-comment"># remove trailing entries for sure</span>
<span class="line-num">137</span>   <span class="ruby-ivar">@entry_overrun</span> = <span class="ruby-node">$&amp;</span>
<span class="line-num">138</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-aalen" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">aalen</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returens the length of <a href="Sequence/AA.html"><code>Bio::Sequence::AA</code></a>.</p>
          
          

          
          <div class="method-source-code" id="aalen-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">223</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">aalen</span>
<span class="line-num">224</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">aaseq</span>.<span class="ruby-identifier">length</span>
<span class="line-num">225</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-aaseq" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">aaseq</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returens the <a href="Sequence/AA.html"><code>Bio::Sequence::AA</code></a>.</p>
          
          

          
          <div class="method-source-code" id="aaseq-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">218</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">aaseq</span>
<span class="line-num">219</span>   <span class="ruby-constant">Sequence</span><span class="ruby-operator">::</span><span class="ruby-constant">AA</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">seq</span>)
<span class="line-num">220</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-acc_version" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">acc_version</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns accession number with version.</p>
          
          

          
          <div class="method-source-code" id="acc_version-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">279</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">acc_version</span>
<span class="line-num">280</span>   <span class="ruby-identifier">identifiers</span>.<span class="ruby-identifier">acc_version</span>
<span class="line-num">281</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-accession" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">accession</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an accession number.</p>
          
          

          
          <div class="method-source-code" id="accession-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">267</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">accession</span>
<span class="line-num">268</span>   <span class="ruby-identifier">identifiers</span>.<span class="ruby-identifier">accession</span>
<span class="line-num">269</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-accessions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">accessions</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Parsing FASTA Defline (using <a href="FastaFormat.html#method-i-identifiers"><code>identifiers</code></a> method), and shows accession numbers. It returns an array of strings.</p>
          
          

          
          <div class="method-source-code" id="accessions-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">274</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">accessions</span>
<span class="line-num">275</span>   <span class="ruby-identifier">identifiers</span>.<span class="ruby-identifier">accessions</span>
<span class="line-num">276</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-blast" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">blast</span><span
            class="method-args">(factory)</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="FastaFormat.html#method-i-query">query</a>
        </div>
        
      </div>

    
      <div id="method-i-comment" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">comment</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns comments.</p>
          
          

          
          <div class="method-source-code" id="comment-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">197</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">comment</span>
<span class="line-num">198</span>   <span class="ruby-identifier">seq</span>
<span class="line-num">199</span>   <span class="ruby-ivar">@comment</span>
<span class="line-num">200</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-entry" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">entry</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the stored one entry as a FASTA format. (same as <a href="FastaFormat.html#method-i-to_s"><code>to_s</code></a>)</p>
          
          

          
          <div class="method-source-code" id="entry-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">141</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">entry</span>
<span class="line-num">142</span>   <span class="ruby-ivar">@entry</span> = <span class="ruby-node">&quot;&gt;#{@definition}\n#{@data.strip}\n&quot;</span>
<span class="line-num">143</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="FastaFormat.html#method-i-to_s">to_s</a>
        </div>
        

        
      </div>

    
      <div id="method-i-entry_id" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">entry_id</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Parsing FASTA Defline (using <a href="FastaFormat.html#method-i-identifiers"><code>identifiers</code></a> method), and shows a possibly unique identifier. It returns a string.</p>
          
          

          
          <div class="method-source-code" id="entry_id-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">253</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">entry_id</span>
<span class="line-num">254</span>   <span class="ruby-identifier">identifiers</span>.<span class="ruby-identifier">entry_id</span>
<span class="line-num">255</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-fasta" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">fasta</span><span
            class="method-args">(factory)</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="FastaFormat.html#method-i-query">query</a>
        </div>
        
      </div>

    
      <div id="method-i-first_name" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">first_name</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the first name (word) of the definition line - everything before the first whitespace.</p>

<pre>&gt;abc def #=&gt; &#39;abc&#39;
&gt;gi|398365175|ref|NP_009718.3| Cdc28p [Saccharomyces cerevisiae S288c] #=&gt; &#39;gi|398365175|ref|NP_009718.3|&#39;
&gt;abc #=&gt; &#39;abc&#39;</pre>
          
          

          
          <div class="method-source-code" id="first_name-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">294</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">first_name</span>
<span class="line-num">295</span>   <span class="ruby-identifier">index</span> = <span class="ruby-identifier">definition</span>.<span class="ruby-identifier">index</span>(<span class="ruby-regexp">/\s/</span>)
<span class="line-num">296</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">index</span>.<span class="ruby-identifier">nil?</span>
<span class="line-num">297</span>     <span class="ruby-keyword">return</span> <span class="ruby-ivar">@definition</span>
<span class="line-num">298</span>   <span class="ruby-keyword">else</span>
<span class="line-num">299</span>     <span class="ruby-keyword">return</span> <span class="ruby-ivar">@definition</span>[<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">index</span>]
<span class="line-num">300</span>   <span class="ruby-keyword">end</span>
<span class="line-num">301</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-gi" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">gi</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Parsing FASTA Defline (using <a href="FastaFormat.html#method-i-identifiers"><code>identifiers</code></a> method), and shows GI/locus/accession/accession with version number. If a entry has more than two of such IDs, only the first ID are shown. It returns a string or nil.</p>
          
          

          
          <div class="method-source-code" id="gi-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">262</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">gi</span>
<span class="line-num">263</span>   <span class="ruby-identifier">identifiers</span>.<span class="ruby-identifier">gi</span>
<span class="line-num">264</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-identifiers" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">identifiers</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Parsing FASTA Defline, and extract IDs. IDs are NSIDs (NCBI standard FASTA sequence identifiers) or “:”-separated IDs. It returns a <a href="FastaDefline.html"><code>Bio::FastaDefline</code></a> instance.</p>
          
          

          
          <div class="method-source-code" id="identifiers-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">243</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">identifiers</span>
<span class="line-num">244</span>   <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@ids</span>) <span class="ruby-keyword">then</span>
<span class="line-num">245</span>     <span class="ruby-ivar">@ids</span> = <span class="ruby-constant">FastaDefline</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@definition</span>)
<span class="line-num">246</span>   <span class="ruby-keyword">end</span>
<span class="line-num">247</span>   <span class="ruby-ivar">@ids</span>
<span class="line-num">248</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-length" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">length</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns sequence length.</p>
          
          

          
          <div class="method-source-code" id="length-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">203</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">length</span>
<span class="line-num">204</span>   <span class="ruby-identifier">seq</span>.<span class="ruby-identifier">length</span>
<span class="line-num">205</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-locus" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">locus</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns locus.</p>
          
          

          
          <div class="method-source-code" id="locus-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">284</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">locus</span>
<span class="line-num">285</span>   <span class="ruby-identifier">identifiers</span>.<span class="ruby-identifier">locus</span>
<span class="line-num">286</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-nalen" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">nalen</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returens the length of <a href="Sequence/NA.html"><code>Bio::Sequence::NA</code></a>.</p>
          
          

          
          <div class="method-source-code" id="nalen-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">213</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">nalen</span>
<span class="line-num">214</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">naseq</span>.<span class="ruby-identifier">length</span>
<span class="line-num">215</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-naseq" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">naseq</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returens the <a href="Sequence/NA.html"><code>Bio::Sequence::NA</code></a>.</p>
          
          

          
          <div class="method-source-code" id="naseq-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">208</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">naseq</span>
<span class="line-num">209</span>   <span class="ruby-constant">Sequence</span><span class="ruby-operator">::</span><span class="ruby-constant">NA</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">seq</span>)
<span class="line-num">210</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-query" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">query</span><span
            class="method-args">(factory)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Executes FASTA/BLAST search by using a <a href="Fasta.html"><code>Bio::Fasta</code></a> or a <a href="Blast.html"><code>Bio::Blast</code></a> factory object.</p>

<pre class="ruby"><span class="ruby-comment">#!/usr/bin/env ruby</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;bio&#39;</span>

<span class="ruby-identifier">factory</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Fasta</span>.<span class="ruby-identifier">local</span>(<span class="ruby-string">&#39;fasta34&#39;</span>, <span class="ruby-string">&#39;db/swissprot.f&#39;</span>)
<span class="ruby-identifier">flatfile</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">FlatFile</span>.<span class="ruby-identifier">open</span>(<span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">FastaFormat</span>, <span class="ruby-string">&#39;queries.f&#39;</span>)
<span class="ruby-identifier">flatfile</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entry</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">p</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">definition</span>
  <span class="ruby-identifier">result</span> = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">fasta</span>(<span class="ruby-identifier">factory</span>)
  <span class="ruby-identifier">result</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hit</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">print</span> <span class="ruby-node">&quot;#{hit.query_id} : #{hit.evalue}\t#{hit.target_id} at &quot;</span>
    <span class="ruby-identifier">p</span> <span class="ruby-identifier">hit</span>.<span class="ruby-identifier">lap_at</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>
          
          

          
          <div class="method-source-code" id="query-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">164</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">query</span>(<span class="ruby-identifier">factory</span>)
<span class="line-num">165</span>   <span class="ruby-identifier">factory</span>.<span class="ruby-identifier">query</span>(<span class="ruby-identifier">entry</span>)
<span class="line-num">166</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="FastaFormat.html#method-i-fasta">fasta</a>, <a href="FastaFormat.html#method-i-blast">blast</a>
        </div>
        

        
      </div>

    
      <div id="method-i-seq" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">seq</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a joined sequence line as a String.</p>
          
          

          
          <div class="method-source-code" id="seq-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">171</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">seq</span>
<span class="line-num">172</span>   <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@seq</span>)
<span class="line-num">173</span>     <span class="ruby-keyword">unless</span> <span class="ruby-regexp">/\A\s*^\#/</span> <span class="ruby-operator">=~</span> <span class="ruby-ivar">@data</span> <span class="ruby-keyword">then</span>
<span class="line-num">174</span>       <span class="ruby-ivar">@seq</span> = <span class="ruby-constant">Sequence</span><span class="ruby-operator">::</span><span class="ruby-constant">Generic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@data</span>.<span class="ruby-identifier">tr</span>(<span class="ruby-string">&quot; \t\r\n0-9&quot;</span>, <span class="ruby-string">&#39;&#39;</span>)) <span class="ruby-comment"># lazy clean up</span>
<span class="line-num">175</span>     <span class="ruby-keyword">else</span>
<span class="line-num">176</span>       <span class="ruby-identifier">a</span> = <span class="ruby-ivar">@data</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">/(^\#.*$)/</span>)
<span class="line-num">177</span>       <span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>
<span class="line-num">178</span>       <span class="ruby-identifier">cmnt</span> = {}
<span class="line-num">179</span>       <span class="ruby-identifier">s</span> = []
<span class="line-num">180</span>       <span class="ruby-identifier">a</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
<span class="line-num">181</span>         <span class="ruby-keyword">if</span> <span class="ruby-regexp">/^# ?(.*)$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">x</span> <span class="ruby-keyword">then</span>
<span class="line-num">182</span>           <span class="ruby-identifier">cmnt</span>[<span class="ruby-identifier">i</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">cmnt</span>[<span class="ruby-identifier">i</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">$1</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">cmnt</span>[<span class="ruby-identifier">i</span>] = <span class="ruby-node">$1</span>
<span class="line-num">183</span>         <span class="ruby-keyword">else</span>
<span class="line-num">184</span>           <span class="ruby-identifier">x</span>.<span class="ruby-identifier">tr!</span>(<span class="ruby-string">&quot; \t\r\n0-9&quot;</span>, <span class="ruby-string">&#39;&#39;</span>) <span class="ruby-comment"># lazy clean up</span>
<span class="line-num">185</span>           <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">length</span>
<span class="line-num">186</span>           <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">x</span>
<span class="line-num">187</span>         <span class="ruby-keyword">end</span>
<span class="line-num">188</span>       <span class="ruby-keyword">end</span>
<span class="line-num">189</span>       <span class="ruby-ivar">@comment</span> = <span class="ruby-identifier">cmnt</span>
<span class="line-num">190</span>       <span class="ruby-ivar">@seq</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Sequence</span><span class="ruby-operator">::</span><span class="ruby-constant">Generic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">s</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39;&#39;</span>))
<span class="line-num">191</span>     <span class="ruby-keyword">end</span>
<span class="line-num">192</span>   <span class="ruby-keyword">end</span>
<span class="line-num">193</span>   <span class="ruby-ivar">@seq</span>
<span class="line-num">194</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-to_biosequence" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_biosequence</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns sequence as a <a href="Sequence.html"><code>Bio::Sequence</code></a> object.</p>

<p>Note: If you modify the returned <a href="Sequence.html"><code>Bio::Sequence</code></a> object, the sequence or definition in this <a href="FastaFormat.html"><code>FastaFormat</code></a> object might also be changed (but not always be changed) because of efficiency.</p>
          
          

          
          <div class="method-source-code" id="to_biosequence-source">
            <pre>    <span class="ruby-comment"># File lib/bio/db/fasta.rb</span>
<span class="line-num">234</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">to_biosequence</span>
<span class="line-num">235</span>   <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Sequence</span>.<span class="ruby-identifier">adapter</span>(<span class="ruby-keyword">self</span>, <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Sequence</span><span class="ruby-operator">::</span><span class="ruby-constant">Adapter</span><span class="ruby-operator">::</span><span class="ruby-constant">FastaFormat</span>)
<span class="line-num">236</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="FastaFormat.html#method-i-to_seq">to_seq</a>
        </div>
        

        
      </div>

    
      <div id="method-i-to_s" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">to_s</span><span
            class="method-args">()</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="FastaFormat.html#method-i-entry">entry</a>
        </div>
        
      </div>

    
      <div id="method-i-to_seq" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">to_seq</span><span
            class="method-args">()</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="FastaFormat.html#method-i-to_biosequence">to_biosequence</a>
        </div>
        
      </div>

    
    </section>
  
  </section>

</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

