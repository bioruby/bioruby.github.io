<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Bio::Blast - BioRuby API documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#class-Bio::Blast-label-Description">Description</a>
    <li><a href="#class-Bio::Blast-label-Usage">Usage</a>
    <li><a href="#class-Bio::Blast-label-See+also">See also</a>
    <li><a href="#class-Bio::Blast-label-References">References</a>
  </ul>
</div>


  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="../Object.html">Object</a>
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-local">::local</a>
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-c-remote">::remote</a>
    
    <li ><a href="#method-c-reports">::reports</a>
    
    <li ><a href="#method-c-reports_xml">::reports_xml</a>
    
    <li ><a href="#method-i-option">#option</a>
    
    <li ><a href="#method-i-option-3D">#option=</a>
    
    <li ><a href="#method-i-options-3D">#options=</a>
    
    <li ><a href="#method-i-query">#query</a>
    
    <li ><a href="#method-i-server-3D">#server=</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Bio::Blast">
  <h1 id="class-Bio::Blast" class="class">
    class Bio::Blast
  </h1>

  <section class="description">
    
<h2 id="class-Bio::Blast-label-Description">Description<span><a href="#class-Bio::Blast-label-Description">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The <a href="Blast.html">Bio::Blast</a> class contains methods for running
local or remote BLAST searches, as well as for parsing of the output of
such BLASTs (i.e. the BLAST reports). For more information on similarity
searches and the BLAST program, see <a
href="http://www.ncbi.nlm.nih.gov/Education/BLASTinfo/similarity.html">www.ncbi.nlm.nih.gov/Education/BLASTinfo/similarity.html</a>.</p>

<h2 id="class-Bio::Blast-label-Usage">Usage<span><a href="#class-Bio::Blast-label-Usage">&para;</a> <a href="#top">&uarr;</a></span></h2>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;bio&#39;</span>

<span class="ruby-comment"># To run an actual BLAST analysis:</span>
<span class="ruby-comment">#   1. create a BLAST factory</span>
<span class="ruby-identifier">remote_blast_factory</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Blast</span>.<span class="ruby-identifier">remote</span>(<span class="ruby-string">&#39;blastp&#39;</span>, <span class="ruby-string">&#39;swissprot&#39;</span>,
                                         <span class="ruby-string">&#39;-e 0.0001&#39;</span>, <span class="ruby-string">&#39;genomenet&#39;</span>)
<span class="ruby-comment">#or:</span>
<span class="ruby-identifier">local_blast_factory</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Blast</span>.<span class="ruby-identifier">local</span>(<span class="ruby-string">&#39;blastn&#39;</span>,<span class="ruby-string">&#39;/path/to/db&#39;</span>)

<span class="ruby-comment">#   2. run the actual BLAST by querying the factory</span>
<span class="ruby-identifier">report</span> = <span class="ruby-identifier">remote_blast_factory</span>.<span class="ruby-identifier">query</span>(<span class="ruby-identifier">sequence_text</span>)

<span class="ruby-comment"># Then, to parse the report, see Bio::Blast::Report</span>
</pre>

<h2 id="class-Bio::Blast-label-See+also">See also<span><a href="#class-Bio::Blast-label-See+also">&para;</a> <a href="#top">&uarr;</a></span></h2>
<ul><li>
<p><a href="Blast/Report.html">Bio::Blast::Report</a></p>
</li><li>
<p><a href="Blast/Report/Hit.html">Bio::Blast::Report::Hit</a></p>
</li><li>
<p><a href="Blast/Report/Hsp.html">Bio::Blast::Report::Hsp</a></p>
</li></ul>

<h2 id="class-Bio::Blast-label-References"><a href="References.html">References</a><span><a href="#class-Bio::Blast-label-References">&para;</a> <a href="#top">&uarr;</a></span></h2>
<ul><li>
<p><a href="http://www.ncbi.nlm.nih.gov/blast">www.ncbi.nlm.nih.gov/blast</a>/</p>
</li><li>
<p><a
href="http://www.ncbi.nlm.nih.gov/Education/BLASTinfo/similarity.html">www.ncbi.nlm.nih.gov/Education/BLASTinfo/similarity.html</a></p>
</li><li>
<p><a
href="http://blast.genome.jp/ideas/ideas.html#blast">blast.genome.jp/ideas/ideas.html#blast</a></p>
</li></ul>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-blastall" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">blastall</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Full path for blastall. (default: &#39;blastall&#39;).</p>
        
        </div>
      </div>
      
      <div id="attribute-i-db" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">db</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Database name (<em>-d</em> option for blastall)</p>
        
        </div>
      </div>
      
      <div id="attribute-i-filter" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">filter</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Filter option for blastall -F (T or F).</p>
        
        </div>
      </div>
      
      <div id="attribute-i-format" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">format</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Output report format for blastall -m</p>

<p>0, pairwise; 1; 2; 3; 4; 5; 6; 7, XML <a href="Blast.html">Blast</a>
outpu;, 8, tabular;  9, tabular with comment lines; 10, ASN text; 11, ASN
binery [intege].</p>
        
        </div>
      </div>
      
      <div id="attribute-i-matrix" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">matrix</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Substitution matrix for blastall -M</p>
        
        </div>
      </div>
      
      <div id="attribute-i-options" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">options</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Options for blastall</p>
        
        </div>
      </div>
      
      <div id="attribute-i-output" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">output</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Returns a <a href="../String.html">String</a> containing blast execution
output in as is the <a href="Blast.html#attribute-i-format">#format</a>.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-parser" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">parser</span><span
            class="attribute-access-type">[W]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-program" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">program</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Program name (<em>-p</em> option for blastall): blastp, blastn, blastx,
tblastn or tblastx</p>
        
        </div>
      </div>
      
      <div id="attribute-i-server" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">server</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Server to submit the BLASTs to</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-local" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">local</span><span
            class="method-args">(program, db, options = '', blastall = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>This is a shortcut for <a href="Blast.html#method-c-new">::new</a>:</p>

<pre class="ruby"><span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Blast</span>.<span class="ruby-identifier">local</span>(<span class="ruby-identifier">program</span>, <span class="ruby-identifier">database</span>, <span class="ruby-identifier">options</span>)
</pre>

<p>is equivalent to</p>

<pre class="ruby"><span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Blast</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">program</span>, <span class="ruby-identifier">database</span>, <span class="ruby-identifier">options</span>, <span class="ruby-string">&#39;local&#39;</span>)
</pre>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p><em>program</em> (required): &#39;blastn&#39;, &#39;blastp&#39;,
&#39;blastx&#39;, &#39;tblastn&#39; or &#39;tblastx&#39;</p>
</li><li>
<p><em>db</em> (required): name of the local database</p>
</li><li>
<p><em>options</em>: blastall options \</p>
</li></ul>

<p>(see <a
href="http://www.genome.jp/dbget-bin/show_man?blast2">www.genome.jp/dbget-bin/show_man?blast2</a>)</p>
<ul><li>
<p><em>blastall</em>: full path to blastall program (e.g. “/opt/bin/blastall”;
DEFAULT: “blastall”)</p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p><a href="Blast.html">Bio::Blast</a> factory object</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="local-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/blast.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">local</span>(<span class="ruby-identifier">program</span>, <span class="ruby-identifier">db</span>, <span class="ruby-identifier">options</span> = <span class="ruby-string">&#39;&#39;</span>, <span class="ruby-identifier">blastall</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">f</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">program</span>, <span class="ruby-identifier">db</span>, <span class="ruby-identifier">options</span>, <span class="ruby-string">&#39;local&#39;</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">blastall</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">blastall</span> = <span class="ruby-identifier">blastall</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">f</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(program, db, opt = [], server = 'local')</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates a <a href="Blast.html">Bio::Blast</a> factory object.</p>

<p>To run any BLAST searches, a factory has to be created that describes a
certain BLAST pipeline: the program to use, the database to search, any
options and the server to use. E.g.</p>

<pre class="ruby"><span class="ruby-identifier">blast_factory</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Blast</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;blastn&#39;</span>,<span class="ruby-string">&#39;dbsts&#39;</span>, <span class="ruby-string">&#39;-e 0.0001 -r 4&#39;</span>, <span class="ruby-string">&#39;genomenet&#39;</span>)
</pre>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p><em>program</em> (required): &#39;blastn&#39;, &#39;blastp&#39;,
&#39;blastx&#39;, &#39;tblastn&#39; or &#39;tblastx&#39;</p>
</li><li>
<p><em>db</em> (required): name of the (local or remote) database</p>
</li><li>
<p><em>options</em>: blastall options \</p>
</li></ul>

<p>(see <a
href="http://www.genome.jp/dbget-bin/show_man?blast2">www.genome.jp/dbget-bin/show_man?blast2</a>)</p>
<ul><li>
<p><em>server</em>: server to use (e.g. &#39;genomenet&#39;; DEFAULT =
&#39;local&#39;)</p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p><a href="Blast.html">Bio::Blast</a> factory object</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/blast.rb, line 316</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">program</span>, <span class="ruby-identifier">db</span>, <span class="ruby-identifier">opt</span> = [], <span class="ruby-identifier">server</span> = <span class="ruby-string">&#39;local&#39;</span>)
  <span class="ruby-ivar">@program</span>  = <span class="ruby-identifier">program</span>
  <span class="ruby-ivar">@db</span>       = <span class="ruby-identifier">db</span>

  <span class="ruby-ivar">@blastall</span> = <span class="ruby-string">&#39;blastall&#39;</span>
  <span class="ruby-ivar">@matrix</span>   = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@filter</span>   = <span class="ruby-keyword">nil</span>

  <span class="ruby-ivar">@output</span>   = <span class="ruby-string">&#39;&#39;</span>
  <span class="ruby-ivar">@parser</span>   = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@format</span>   = <span class="ruby-keyword">nil</span>

  <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">set_options</span>(<span class="ruby-identifier">opt</span>, <span class="ruby-identifier">program</span>, <span class="ruby-identifier">db</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">server</span> = <span class="ruby-identifier">server</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-remote" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remote</span><span
            class="method-args">(program, db, option = '', server = 'genomenet')</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p><a href="Blast.html#method-c-remote">::remote</a> does exactly the same as
<a href="Blast.html#method-c-new">::new</a>, but sets the remote server
&#39;genomenet&#39; as its default.</p>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p><em>program</em> (required): &#39;blastn&#39;, &#39;blastp&#39;,
&#39;blastx&#39;, &#39;tblastn&#39; or &#39;tblastx&#39;</p>
</li><li>
<p><em>db</em> (required): name of the remote database</p>
</li><li>
<p><em>options</em>: blastall options \</p>
</li></ul>

<p>(see <a
href="http://www.genome.jp/dbget-bin/show_man?blast2">www.genome.jp/dbget-bin/show_man?blast2</a>)</p>
<ul><li>
<p><em>server</em>: server to use (DEFAULT = &#39;genomenet&#39;)</p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p><a href="Blast.html">Bio::Blast</a> factory object</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="remote-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/blast.rb, line 96</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">remote</span>(<span class="ruby-identifier">program</span>, <span class="ruby-identifier">db</span>, <span class="ruby-identifier">option</span> = <span class="ruby-string">&#39;&#39;</span>, <span class="ruby-identifier">server</span> = <span class="ruby-string">&#39;genomenet&#39;</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">program</span>, <span class="ruby-identifier">db</span>, <span class="ruby-identifier">option</span>, <span class="ruby-identifier">server</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-reports" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reports</span><span
            class="method-args">(input, parser = nil) { |e| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Bio::Blast.report parses given data,  and returns an array of report 
(Bio::Blast::Report or <a
href="Blast/Default/Report.html">Bio::Blast::Default::Report</a>) objects,
or yields each report object when a block is given.</p>

<p>Supported formats: <a href="NCBI.html">NCBI</a> default (-m 0), XML (-m 7),
tabular (-m 8).</p>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p><em>input</em> (required): input data</p>
</li><li>
<p><em>parser</em>: type of parser. see <a
href="Blast/Report.html#method-c-new">Bio::Blast::Report.new</a></p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>Undefiend when a block is given. Otherwise, an Array containing report
(Bio::Blast::Report or <a
href="Blast/Default/Report.html">Bio::Blast::Default::Report</a>) objects.</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="reports-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/blast.rb, line 113</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">reports</span>(<span class="ruby-identifier">input</span>, <span class="ruby-identifier">parser</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">istr</span> = <span class="ruby-identifier">input</span>.<span class="ruby-identifier">to_str</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
    <span class="ruby-identifier">istr</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">istr</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">input</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">istr</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-string">&#39;unsupported input data type&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">input</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:gets</span>)

  <span class="ruby-comment"># if proper parser is given, emulates old behavior.</span>
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">parser</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:xmlparser</span>, <span class="ruby-value">:rexml</span>
    <span class="ruby-identifier">ff</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">FlatFile</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Blast</span><span class="ruby-operator">::</span><span class="ruby-constant">Report</span>, <span class="ruby-identifier">input</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">ff</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword">yield</span> <span class="ruby-identifier">e</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">return</span> []
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">ff</span>.<span class="ruby-identifier">to_a</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:tab</span>
    <span class="ruby-identifier">istr</span> = <span class="ruby-identifier">input</span>.<span class="ruby-identifier">read</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">istr</span>
    <span class="ruby-identifier">rep</span> = <span class="ruby-constant">Report</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">istr</span>, <span class="ruby-identifier">parser</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span> <span class="ruby-keyword">then</span>
      <span class="ruby-keyword">yield</span> <span class="ruby-identifier">rep</span>
      <span class="ruby-keyword">return</span> []
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">return</span> [ <span class="ruby-identifier">rep</span> ]
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># preparation of the new format autodetection rule if needed</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword">defined?</span>(<span class="ruby-identifier">@@reports_format_autodetection_rule</span>) <span class="ruby-keyword">or</span>
      <span class="ruby-operator">!</span><span class="ruby-identifier">@@reports_format_autodetection_rule</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">regrule</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">FlatFile</span><span class="ruby-operator">::</span><span class="ruby-constant">AutoDetect</span><span class="ruby-operator">::</span><span class="ruby-constant">RuleRegexp</span>
    <span class="ruby-identifier">blastxml</span> = <span class="ruby-identifier">regrule</span>[ <span class="ruby-string">&#39;Bio::Blast::Report&#39;</span>,
                        <span class="ruby-regexp">/\&lt;\!DOCTYPE BlastOutput PUBLIC /</span> ]
    <span class="ruby-identifier">blast</span>    = <span class="ruby-identifier">regrule</span>[ <span class="ruby-string">&#39;Bio::Blast::Default::Report&#39;</span>,
                        <span class="ruby-regexp">/^BLAST.? +[\-\.\w]+ +\[[\-\.\w ]+\]/</span> ]
    <span class="ruby-identifier">tblast</span>   = <span class="ruby-identifier">regrule</span>[ <span class="ruby-string">&#39;Bio::Blast::Default::Report_TBlast&#39;</span>,
                        <span class="ruby-regexp">/^TBLAST.? +[\-\.\w]+ +\[[\-\.\w ]+\]/</span> ]
    <span class="ruby-identifier">tab</span>      = <span class="ruby-identifier">regrule</span>[ <span class="ruby-string">&#39;Bio::Blast::Report_tab&#39;</span>,
                        <span class="ruby-regexp">/^([^\t]*\t){11}[^\t]*$/</span> ]
    <span class="ruby-identifier">auto</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">FlatFile</span><span class="ruby-operator">::</span><span class="ruby-constant">AutoDetect</span>[ <span class="ruby-identifier">blastxml</span>,
                                      <span class="ruby-identifier">blast</span>,
                                      <span class="ruby-identifier">tblast</span>,
                                      <span class="ruby-identifier">tab</span>
                                    ]
    <span class="ruby-comment"># sets priorities</span>
    <span class="ruby-identifier">blastxml</span>.<span class="ruby-identifier">is_prior_to</span> <span class="ruby-identifier">blast</span>
    <span class="ruby-identifier">blast</span>.<span class="ruby-identifier">is_prior_to</span> <span class="ruby-identifier">tblast</span>
    <span class="ruby-identifier">tblast</span>.<span class="ruby-identifier">is_prior_to</span> <span class="ruby-identifier">tab</span>
    <span class="ruby-comment"># rehash</span>
    <span class="ruby-identifier">auto</span>.<span class="ruby-identifier">rehash</span>
    <span class="ruby-identifier">@@report_format_autodetection_rule</span> = <span class="ruby-identifier">auto</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Creates a FlatFile object with dummy class</span>
  <span class="ruby-identifier">ff</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">FlatFile</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Object</span>, <span class="ruby-identifier">input</span>)
  <span class="ruby-identifier">ff</span>.<span class="ruby-identifier">dbclass</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># file format autodetection</span>
  <span class="ruby-value">3</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">ff</span>.<span class="ruby-identifier">eof?</span> <span class="ruby-keyword">or</span>
      <span class="ruby-identifier">ff</span>.<span class="ruby-identifier">autodetect</span>(<span class="ruby-value">31</span>, <span class="ruby-identifier">@@report_format_autodetection_rule</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># If format detection failed, assumed to be tabular (-m 8)</span>
  <span class="ruby-identifier">ff</span>.<span class="ruby-identifier">dbclass</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Blast</span><span class="ruby-operator">::</span><span class="ruby-constant">Report_tab</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">ff</span>.<span class="ruby-identifier">dbclass</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">ff</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entry</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">yield</span> <span class="ruby-identifier">entry</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">ret</span> = []
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">ff</span>.<span class="ruby-identifier">to_a</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">ret</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-reports_xml" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reports_xml</span><span
            class="method-args">(input, parser = nil) { |r| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Note that this is the old implementation of <a
href="Blast.html#method-c-reports">::reports</a>. The aim of this method is
keeping compatibility for older BLAST XML documents which might not be
parsed by the new <a href="Blast.html#method-c-reports">::reports</a> nor
<a href="FlatFile.html">Bio::FlatFile</a>. (Though we are not sure whether
such documents exist or not.)</p>

<p><a href="Blast.html#method-c-reports_xml">::reports_xml</a> parses given
data,  and returns an array of <a
href="Blast/Report.html">Bio::Blast::Report</a> objects, or yields each <a
href="Blast/Report.html">Bio::Blast::Report</a> object when a block is
given.</p>

<p>It can be used only for XML format. For default (-m 0) format, consider
using <a href="FlatFile.html">Bio::FlatFile</a>, or <a
href="Blast.html#method-c-reports">::reports</a>.</p>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p><em>input</em> (required): input data</p>
</li><li>
<p><em>parser</em>: type of parser. see <a
href="Blast/Report.html#method-c-new">Bio::Blast::Report.new</a></p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>Undefiend when a block is given. Otherwise, an Array containing <a
href="Blast/Report.html">Bio::Blast::Report</a> objects.</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="reports_xml-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/blast.rb, line 219</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">reports_xml</span>(<span class="ruby-identifier">input</span>, <span class="ruby-identifier">parser</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">ary</span> = []
  <span class="ruby-identifier">input</span>.<span class="ruby-identifier">each_line</span>(<span class="ruby-string">&quot;&lt;/BlastOutput&gt;\n&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">xml</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp">/[^&lt;]*(&lt;?)/</span>, <span class="ruby-string">&#39;\1&#39;</span>) <span class="ruby-comment"># skip before &lt;?xml&gt; tag</span>
    <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">empty?</span>          <span class="ruby-comment"># skip trailing no hits</span>
    <span class="ruby-identifier">rep</span> = <span class="ruby-constant">Report</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">xml</span>, <span class="ruby-identifier">parser</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">rep</span>.<span class="ruby-identifier">reports</span> <span class="ruby-keyword">then</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
        <span class="ruby-identifier">rep</span>.<span class="ruby-identifier">reports</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">r</span> }
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">ary</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">rep</span>.<span class="ruby-identifier">reports</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
        <span class="ruby-keyword">yield</span> <span class="ruby-identifier">rep</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">ary</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">rep</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">ary</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-option" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">option</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns options of blastall</p>
          
          

          
          <div class="method-source-code" id="option-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/blast.rb, line 373</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">option</span>
  <span class="ruby-comment"># backward compatibility</span>
  <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Command</span>.<span class="ruby-identifier">make_command_line</span>(<span class="ruby-identifier">options</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-option-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">option=</span><span
            class="method-args">(str)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set options for blastall</p>
          
          

          
          <div class="method-source-code" id="option-3D-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/blast.rb, line 379</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">option=</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-comment"># backward compatibility</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">options</span> = <span class="ruby-constant">Shellwords</span>.<span class="ruby-identifier">shellwords</span>(<span class="ruby-identifier">str</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-options-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">options=</span><span
            class="method-args">(ary)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sets options for blastall</p>
          
          

          
          <div class="method-source-code" id="options-3D-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/blast.rb, line 254</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">options=</span>(<span class="ruby-identifier">ary</span>)
  <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">set_options</span>(<span class="ruby-identifier">ary</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-query" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">query</span><span
            class="method-args">(query)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>This method submits a sequence to a BLAST factory, which performs the
actual BLAST.</p>

<pre class="ruby"><span class="ruby-comment"># example 1</span>
<span class="ruby-identifier">seq</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Sequence</span><span class="ruby-operator">::</span><span class="ruby-constant">NA</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;agggcattgccccggaagatcaagtcgtgctcctg&#39;</span>)
<span class="ruby-identifier">report</span> = <span class="ruby-identifier">blast_factory</span>.<span class="ruby-identifier">query</span>(<span class="ruby-identifier">seq</span>)

<span class="ruby-comment"># example 2</span>
<span class="ruby-identifier">str</span> <span class="ruby-value">&lt;&lt;END_OF_FASTA
&gt;lcl|MySequence
MPPSAISKISNSTTPQVQSSSAPNLTMLEGKGISVEKSFRVYSEEENQNQHKAKDSLGF
KELEKDAIKNSKQDKKDHKNWLETLYDQAEQKWLQEPKKKLQDLIKNSGDNSRVILKDS
END_OF_FASTA</span>
<span class="ruby-identifier">report</span> = <span class="ruby-identifier">blast_factory</span>.<span class="ruby-identifier">query</span>(<span class="ruby-identifier">str</span>)
</pre>

<p>Bug note: When multi-FASTA is given and the format is 7 (XML) or 8 (tab),
it should return an array of <a
href="Blast/Report.html">Bio::Blast::Report</a> objects, but it returns a
single <a href="Blast/Report.html">Bio::Blast::Report</a> object. This is a
known bug and should be fixed in the future.</p>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p><em>query</em> (required): single- or multiple-FASTA formatted sequence(s)</p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>a <a href="Blast/Report.html">Bio::Blast::Report</a> (or <a
href="Blast/Default/Report.html">Bio::Blast::Default::Report</a>) object
when single query is given. When multiple sequences are given as the query,
it returns an array of <a href="Blast/Report.html">Bio::Blast::Report</a>
(or <a href="Blast/Default/Report.html">Bio::Blast::Default::Report</a>)
objects. If it can not parse result, nil will be returnd.</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="query-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/blast.rb, line 357</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">query</span>(<span class="ruby-identifier">query</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">query</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Sequence</span>
    <span class="ruby-identifier">query</span> = <span class="ruby-identifier">query</span>.<span class="ruby-identifier">output</span>(<span class="ruby-value">:fasta</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Sequence</span><span class="ruby-operator">::</span><span class="ruby-constant">NA</span>, <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Sequence</span><span class="ruby-operator">::</span><span class="ruby-constant">AA</span>, <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Sequence</span><span class="ruby-operator">::</span><span class="ruby-constant">Generic</span>
    <span class="ruby-identifier">query</span> = <span class="ruby-identifier">query</span>.<span class="ruby-identifier">to_fasta</span>(<span class="ruby-string">&#39;query&#39;</span>, <span class="ruby-value">70</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">query</span> = <span class="ruby-identifier">query</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@output</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">__send__</span>(<span class="ruby-node">&quot;exec_#{@server}&quot;</span>, <span class="ruby-identifier">query</span>)
  <span class="ruby-identifier">report</span> = <span class="ruby-identifier">parse_result</span>(<span class="ruby-ivar">@output</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">report</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-server-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">server=</span><span
            class="method-args">(str)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sets server to submit the BLASTs to. The exec_xxxx method should be defined
in <a href="Blast.html">Bio::Blast</a> or Bio::Blast::Remote::Xxxx class.</p>
          
          

          
          <div class="method-source-code" id="server-3D-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/blast.rb, line 264</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">server=</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-ivar">@server</span> = <span class="ruby-identifier">str</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">m</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Blast</span><span class="ruby-operator">::</span><span class="ruby-constant">Remote</span>.<span class="ruby-identifier">const_get</span>(<span class="ruby-ivar">@server</span>.<span class="ruby-identifier">capitalize</span>)
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NameError</span>
    <span class="ruby-identifier">m</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">m</span> <span class="ruby-keyword">and</span> <span class="ruby-operator">!</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-identifier">m</span>)) <span class="ruby-keyword">then</span>
    <span class="ruby-comment"># lazy include Bio::Blast::Remote::XXX module</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">class_eval</span> { <span class="ruby-identifier">include</span> <span class="ruby-identifier">m</span> }
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@server</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.0.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

