<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Bio::Tree - BioRuby API documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="../Object.html">Object</a>
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-add_edge">#add_edge</a>
    
    <li ><a href="#method-i-add_node">#add_node</a>
    
    <li ><a href="#method-i-adjacency_matrix">#adjacency_matrix</a>
    
    <li ><a href="#method-i-adjacent_nodes">#adjacent_nodes</a>
    
    <li ><a href="#method-i-ancestors">#ancestors</a>
    
    <li ><a href="#method-i-children">#children</a>
    
    <li ><a href="#method-i-clear">#clear</a>
    
    <li ><a href="#method-i-clear_node">#clear_node</a>
    
    <li ><a href="#method-i-collect_edge-21">#collect_edge!</a>
    
    <li ><a href="#method-i-collect_node-21">#collect_node!</a>
    
    <li ><a href="#method-i-concat">#concat</a>
    
    <li ><a href="#method-i-descendents">#descendents</a>
    
    <li ><a href="#method-i-distance">#distance</a>
    
    <li ><a href="#method-i-distance_matrix">#distance_matrix</a>
    
    <li ><a href="#method-i-each_edge">#each_edge</a>
    
    <li ><a href="#method-i-each_edge_in_path">#each_edge_in_path</a>
    
    <li ><a href="#method-i-each_node">#each_node</a>
    
    <li ><a href="#method-i-each_out_edge">#each_out_edge</a>
    
    <li ><a href="#method-i-edges">#edges</a>
    
    <li ><a href="#method-i-get_edge">#get_edge</a>
    
    <li ><a href="#method-i-get_edge_distance">#get_edge_distance</a>
    
    <li ><a href="#method-i-get_edge_distance_string">#get_edge_distance_string</a>
    
    <li ><a href="#method-i-get_edge_merged">#get_edge_merged</a>
    
    <li ><a href="#method-i-get_node_bootstrap">#get_node_bootstrap</a>
    
    <li ><a href="#method-i-get_node_bootstrap_string">#get_node_bootstrap_string</a>
    
    <li ><a href="#method-i-get_node_by_name">#get_node_by_name</a>
    
    <li ><a href="#method-i-get_node_name">#get_node_name</a>
    
    <li ><a href="#method-i-include-3F">#include?</a>
    
    <li ><a href="#method-i-insert_node">#insert_node</a>
    
    <li ><a href="#method-i-leaves">#leaves</a>
    
    <li ><a href="#method-i-lowest_common_ancestor">#lowest_common_ancestor</a>
    
    <li ><a href="#method-i-newick">#newick</a>
    
    <li ><a href="#method-i-nodes">#nodes</a>
    
    <li ><a href="#method-i-number_of_edges">#number_of_edges</a>
    
    <li ><a href="#method-i-number_of_nodes">#number_of_nodes</a>
    
    <li ><a href="#method-i-out_degree">#out_degree</a>
    
    <li ><a href="#method-i-out_edges">#out_edges</a>
    
    <li ><a href="#method-i-output">#output</a>
    
    <li ><a href="#method-i-output_newick">#output_newick</a>
    
    <li ><a href="#method-i-output_nhx">#output_nhx</a>
    
    <li ><a href="#method-i-output_phylip_distance_matrix">#output_phylip_distance_matrix</a>
    
    <li ><a href="#method-i-parent">#parent</a>
    
    <li ><a href="#method-i-path">#path</a>
    
    <li ><a href="#method-i-remove_edge">#remove_edge</a>
    
    <li ><a href="#method-i-remove_edge_if">#remove_edge_if</a>
    
    <li ><a href="#method-i-remove_node">#remove_node</a>
    
    <li ><a href="#method-i-remove_node_if">#remove_node_if</a>
    
    <li ><a href="#method-i-remove_nonsense_nodes">#remove_nonsense_nodes</a>
    
    <li ><a href="#method-i-subtree">#subtree</a>
    
    <li ><a href="#method-i-subtree_with_all_paths">#subtree_with_all_paths</a>
    
    <li ><a href="#method-i-total_distance">#total_distance</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Bio::Tree">
  <h1 id="class-Bio::Tree" class="class">
    class Bio::Tree
  </h1>

  <section class="description">
    
<p>This is the class for phylogenetic tree. It stores a phylogenetic tree.</p>

<p>Internally, it is based on <a href="Pathway.html">Bio::Pathway</a> class.
However, users cannot handle <a href="Pathway.html">Bio::Pathway</a> object
directly.</p>

<p>This is alpha version. Incompatible changes may be made frequently.</p>

  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="DEFAULT_OPTIONS">DEFAULT_OPTIONS
        
        <dd><p>default options</p>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-options" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">options</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>tree options; mainly used for tree output</p>
        
        </div>
      </div>
      
      <div id="attribute-i-root" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">root</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>root node of this tree (even if unrooted tree, it is used by some methods)</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(tree = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates a new phylogenetic tree. When no arguments are given, it creates a
new empty tree. When a <a href="Tree.html">Tree</a> object is given, it
copies the tree. Note that the  new tree shares <a
href="Tree/Node.html">Node</a> and <a href="Tree/Edge.html">Edge</a>
objects with the given tree.</p>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 258</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">tree</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-comment"># creates an undirected adjacency list graph</span>
  <span class="ruby-ivar">@pathway</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Pathway</span>.<span class="ruby-identifier">new</span>([], <span class="ruby-keyword">true</span>)
  <span class="ruby-ivar">@root</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@options</span> = {}
  <span class="ruby-identifier">_init_cache</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">tree</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">tree</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-add_edge" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_edge</span><span
            class="method-args">(source, target, edge = Edge.new)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds a new edge to the tree. Returns the newly added edge. If the edge
already exists, it is overwritten with new one.</p>
          
          

          
          <div class="method-source-code" id="add_edge-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 380</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_edge</span>(<span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span>, <span class="ruby-identifier">edge</span> = <span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>)
  <span class="ruby-identifier">_clear_cache</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">append</span>(<span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Relation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span>, <span class="ruby-identifier">edge</span>))
  <span class="ruby-identifier">edge</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_node" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_node</span><span
            class="method-args">(node)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds a node to the tree. Returns self. If the node already exists, it does
nothing.</p>
          
          

          
          <div class="method-source-code" id="add_node-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 402</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_node</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-identifier">_clear_cache</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">node</span>] <span class="ruby-operator">||=</span> {}
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-adjacency_matrix" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">adjacency_matrix</span><span
            class="method-args">(nodes = nil, default_value = nil, diagonal_value = nil) { |source, target, edge| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Shows the adjacency matrix representation of the tree. It shows matrix only
for given nodes. If <em>nodes</em> is nil or is ommitted, it acts the same
as tree.adjacency_matrix(tree.nodes). If a block is given, for each edge,
it yields <em>source</em>, <em>target</em>, and <em>edge</em>, and uses the
returned value of the block. Without blocks, it uses edge. Returns a matrix
object.</p>
          
          

          
          <div class="method-source-code" id="adjacency_matrix-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 822</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">adjacency_matrix</span>(<span class="ruby-identifier">nodes</span> = <span class="ruby-keyword">nil</span>,
                     <span class="ruby-identifier">default_value</span> = <span class="ruby-keyword">nil</span>,
                     <span class="ruby-identifier">diagonal_value</span> = <span class="ruby-keyword">nil</span>) <span class="ruby-comment">#:yields: source, target, edge</span>
  <span class="ruby-identifier">nodes</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">nodes</span>
  <span class="ruby-identifier">size</span> = <span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">size</span>
  <span class="ruby-identifier">hash</span> = {}
  <span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">each_with_index</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">x</span>] = <span class="ruby-identifier">i</span> }
  <span class="ruby-comment"># prepares an matrix</span>
  <span class="ruby-identifier">matrix</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">size</span>, <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">matrix</span>.<span class="ruby-identifier">collect!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">size</span>, <span class="ruby-identifier">default_value</span>) }
  (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">size</span>).<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">matrix</span>[<span class="ruby-identifier">i</span>][<span class="ruby-identifier">i</span>] = <span class="ruby-identifier">diagonal_value</span> }
  <span class="ruby-comment"># fills the matrix from each edge</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">each_edge</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span>, <span class="ruby-identifier">edge</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">i_source</span> = <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">source</span>]
    <span class="ruby-identifier">i_target</span> = <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">target</span>]
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">i_source</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">i_target</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">val</span> = <span class="ruby-identifier">block_given?</span> <span class="ruby-operator">?</span> (<span class="ruby-keyword">yield</span> <span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span>, <span class="ruby-identifier">edge</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">edge</span>
      <span class="ruby-identifier">matrix</span>[<span class="ruby-identifier">i_source</span>][<span class="ruby-identifier">i_target</span>] = <span class="ruby-identifier">val</span>
      <span class="ruby-identifier">matrix</span>[<span class="ruby-identifier">i_target</span>][<span class="ruby-identifier">i_source</span>] = <span class="ruby-identifier">val</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">Matrix</span>.<span class="ruby-identifier">rows</span>(<span class="ruby-identifier">matrix</span>, <span class="ruby-keyword">false</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-adjacent_nodes" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">adjacent_nodes</span><span
            class="method-args">(node)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an array of adjacent nodes of the given node.</p>
          
          

          
          <div class="method-source-code" id="adjacent_nodes-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 331</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">adjacent_nodes</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-identifier">h</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">node</span>]
  <span class="ruby-identifier">h</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">h</span>.<span class="ruby-identifier">keys</span> <span class="ruby-operator">:</span> []
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-ancestors" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ancestors</span><span
            class="method-args">(node, root = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets all ancestral nodes of the <em>node</em>. If <em>root</em> isn&#39;t
specified or <em>root</em> is <code>nil</code>, @root is used. Returns an
array of <code>Node</code>s. The result is unspecified for cyclic trees.</p>
          
          

          
          <div class="method-source-code" id="ancestors-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 757</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">ancestors</span>(<span class="ruby-identifier">node</span>, <span class="ruby-identifier">root</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">root</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@root</span>
  (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>(<span class="ruby-identifier">root</span>, <span class="ruby-identifier">node</span>) <span class="ruby-operator">-</span> [ <span class="ruby-identifier">node</span> ]).<span class="ruby-identifier">reverse</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-children" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">children</span><span
            class="method-args">(node, root = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets the adjacent children nodes of the <em>node</em>. If <em>root</em>
isn&#39;t specified or <em>root</em> is <code>nil</code>, @root is used.
Returns an array of <code>Node</code>s. The result is unspecified for
cyclic trees.</p>
          
          

          
          <div class="method-source-code" id="children-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 701</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">children</span>(<span class="ruby-identifier">node</span>, <span class="ruby-identifier">root</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">root</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@root</span>
  <span class="ruby-identifier">c</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">adjacent_nodes</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">parent</span>(<span class="ruby-identifier">node</span>, <span class="ruby-identifier">root</span>))
  <span class="ruby-identifier">c</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-clear" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">clear</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Clears all nodes and edges. Returns self. Note that options and root are
also cleared.</p>
          
          

          
          <div class="method-source-code" id="clear-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 289</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">clear</span>
  <span class="ruby-identifier">initialize</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-clear_node" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">clear_node</span><span
            class="method-args">(node)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes all edges connected with the node. Returns self. If the node does
not exist, raises IndexError.</p>
          
          

          
          <div class="method-source-code" id="clear_node-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 417</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">clear_node</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">node</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">IndexError</span>, <span class="ruby-string">&#39;the node does not exist&#39;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">_clear_cache</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">relations</span>.<span class="ruby-identifier">delete_if</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rel</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">node</span>].<span class="ruby-identifier">each_key</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">k</span>].<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">node</span>].<span class="ruby-identifier">clear</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-collect_edge-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">collect_edge!</span><span
            class="method-args">() { |source, target, edge| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Replaces each edge by each block&#39;s return value. Returns self.</p>
          
          

          
          <div class="method-source-code" id="collect_edge-21-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 527</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">collect_edge!</span> <span class="ruby-comment">#:yields: source, target, edge</span>
  <span class="ruby-identifier">_clear_cache</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">relations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rel</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">newedge</span> = <span class="ruby-keyword">yield</span> <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>[<span class="ruby-value">1</span>], <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">relation</span>
    <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">edge</span> = <span class="ruby-identifier">newedge</span>
    <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">append</span>(<span class="ruby-identifier">rel</span>, <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-collect_node-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">collect_node!</span><span
            class="method-args">() { |node| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Replaces each node by each block&#39;s return value. Returns self.</p>
          
          

          
          <div class="method-source-code" id="collect_node-21-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 506</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">collect_node!</span> <span class="ruby-comment">#:yields: node</span>
  <span class="ruby-identifier">_clear_cache</span>
  <span class="ruby-identifier">tr</span> = {}
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">each_node</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">tr</span>[<span class="ruby-identifier">node</span>] = <span class="ruby-keyword">yield</span> <span class="ruby-identifier">node</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># replaces nodes in @pathway.relations</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">relations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rel</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>.<span class="ruby-identifier">collect!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span> <span class="ruby-identifier">tr</span>[<span class="ruby-identifier">node</span>] }
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># re-generates @pathway from relations</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">to_list</span>
  <span class="ruby-comment"># adds orphan nodes</span>
  <span class="ruby-identifier">tr</span>.<span class="ruby-identifier">each_value</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">newnode</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">newnode</span>] <span class="ruby-operator">||=</span> {}
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-concat" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">concat</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Concatenates the other tree. If the same edge exists, the edge in
<em>other</em> is used. Returns self. The result is unspecified if
<em>other</em> isn&#39;t a <a href="Tree.html">Tree</a> object. Note that
the <a href="Tree/Node.html">Node</a> and <a href="Tree/Edge.html">Edge</a>
objects in the <em>other</em> tree are shared in the concatinated tree.</p>
          
          

          
          <div class="method-source-code" id="concat-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 595</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">concat</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-comment">#raise TypeError unless other.kind_of?(self.class)</span>
  <span class="ruby-identifier">_clear_cache</span>
  <span class="ruby-identifier">other</span>.<span class="ruby-identifier">each_node</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">add_node</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">other</span>.<span class="ruby-identifier">each_edge</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>, <span class="ruby-identifier">edge</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">add_edge</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>, <span class="ruby-identifier">edge</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-descendents" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">descendents</span><span
            class="method-args">(node, root = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets all descendent nodes of the <em>node</em>. If <em>root</em> isn&#39;t
specified or <em>root</em> is <code>nil</code>, @root is used. Returns an
array of <code>Node</code>s. The result is unspecified for cyclic trees.</p>
          
          

          
          <div class="method-source-code" id="descendents-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 712</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">descendents</span>(<span class="ruby-identifier">node</span>, <span class="ruby-identifier">root</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">root</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@root</span>
  <span class="ruby-identifier">distance</span>, <span class="ruby-identifier">route</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">breadth_first_search</span>(<span class="ruby-identifier">root</span>)
  <span class="ruby-identifier">d</span> = <span class="ruby-identifier">distance</span>[<span class="ruby-identifier">node</span>]
  <span class="ruby-identifier">result</span> = []
  <span class="ruby-identifier">distance</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">d</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">x</span> = <span class="ruby-identifier">key</span>
      <span class="ruby-keyword">while</span> <span class="ruby-identifier">x</span> = <span class="ruby-identifier">route</span>[<span class="ruby-identifier">x</span>]
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">x</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">node</span> <span class="ruby-keyword">then</span>
          <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">key</span>
          <span class="ruby-keyword">break</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">distance</span>[<span class="ruby-identifier">x</span>] <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">d</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">result</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-distance" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">distance</span><span
            class="method-args">(node1, node2)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns distance between node1 and node2. It would raise error if the edges
didn&#39;t contain distance values. The result is unspecified for cyclic
trees.</p>
          
          

          
          <div class="method-source-code" id="distance-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 640</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">distance</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>)
  <span class="ruby-identifier">distance</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">each_edge_in_path</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span>, <span class="ruby-identifier">edge</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">distance</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">get_edge_distance</span>(<span class="ruby-identifier">edge</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">distance</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-distance_matrix" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">distance_matrix</span><span
            class="method-args">(nodes = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Calculates distance matrix of given nodes. If <em>nodes</em> is nil, or is
ommited, it acts the same as tree.distance_matrix(tree.leaves). Returns a
matrix object. The result is unspecified for cyclic trees. Note 1: The
diagonal values of the matrix are 0. Note 2: If the distance cannot be
calculated, nil will be set.</p>
          
          

          
          <div class="method-source-code" id="distance_matrix-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 793</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">distance_matrix</span>(<span class="ruby-identifier">nodes</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">nodes</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">leaves</span>
  <span class="ruby-identifier">matrix</span> = []
  <span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">each_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">row</span> = []
    <span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">each_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">j</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">j</span> <span class="ruby-keyword">then</span>
        <span class="ruby-identifier">distance</span> = <span class="ruby-value">0</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">r</span> = <span class="ruby-identifier">matrix</span>[<span class="ruby-identifier">j</span>] <span class="ruby-keyword">and</span> <span class="ruby-identifier">val</span> = <span class="ruby-identifier">r</span>[<span class="ruby-identifier">i</span>] <span class="ruby-keyword">then</span>
        <span class="ruby-identifier">distance</span> = <span class="ruby-identifier">val</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">distance</span> = (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">distance</span>(<span class="ruby-identifier">nodes</span>[<span class="ruby-identifier">i</span>], <span class="ruby-identifier">nodes</span>[<span class="ruby-identifier">j</span>]) <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">nil</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">row</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">distance</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">matrix</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">row</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">Matrix</span>.<span class="ruby-identifier">rows</span>(<span class="ruby-identifier">matrix</span>, <span class="ruby-keyword">false</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-each_edge" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_edge</span><span
            class="method-args">() { |source, target, edge| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Iterates over each edges of this tree.</p>
          
          

          
          <div class="method-source-code" id="each_edge-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 311</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">each_edge</span> <span class="ruby-comment">#:yields: source, target, edge</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">relations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rel</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>[<span class="ruby-value">1</span>], <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">relation</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-each_edge_in_path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_edge_in_path</span><span
            class="method-args">(node1, node2) { |source, target, edge| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Iterates over each edge from node1 to node2. The result is unspecified for
cyclic trees.</p>
          
          

          
          <div class="method-source-code" id="each_edge_in_path-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 626</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">each_edge_in_path</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>)
  <span class="ruby-identifier">path</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>)
  <span class="ruby-identifier">source</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">shift</span>
  <span class="ruby-identifier">path</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">target</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">edge</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">get_edge</span>(<span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span>)
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span>, <span class="ruby-identifier">edge</span>
    <span class="ruby-identifier">source</span> = <span class="ruby-identifier">target</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-each_node" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_node</span><span
            class="method-args">() { |node| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Iterates over each node of this tree.</p>
          
          

          
          <div class="method-source-code" id="each_node-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 305</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">each_node</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">x</span>) <span class="ruby-comment">#:yields: node</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>.<span class="ruby-identifier">each_key</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">x</span>)
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-each_out_edge" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_out_edge</span><span
            class="method-args">(source) { |source, target, edge| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Iterates over each connected edges of the given node. Returns self.</p>

<p>The reason why the method name is “each_out_edge” is that it comes from the
Boost Graph Library.</p>
          
          

          
          <div class="method-source-code" id="each_out_edge-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 355</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">each_out_edge</span>(<span class="ruby-identifier">source</span>) <span class="ruby-comment">#:yields: source, target, edge</span>
  <span class="ruby-identifier">h</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">source</span>]
  <span class="ruby-identifier">h</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">source</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span> } <span class="ruby-keyword">if</span> <span class="ruby-identifier">h</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-edges" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">edges</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns all edges an array of [ node0, node1, edge ]</p>
          
          

          
          <div class="method-source-code" id="edges-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 319</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">edges</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">relations</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rel</span><span class="ruby-operator">|</span>
    [ <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>[<span class="ruby-value">1</span>], <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">relation</span> ]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_edge" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_edge</span><span
            class="method-args">(source, target)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an edge from source to target. If source and target are not
adjacent nodes, returns nil.</p>
          
          

          
          <div class="method-source-code" id="get_edge-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 372</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_edge</span>(<span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span>)
  <span class="ruby-identifier">h</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">source</span>]
  <span class="ruby-identifier">h</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">target</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_edge_distance" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_edge_distance</span><span
            class="method-args">(edge)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets distance value from the given edge. Returns float or any other numeric
value or nil.</p>
          
          

          
          <div class="method-source-code" id="get_edge_distance-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 100</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_edge_distance</span>(<span class="ruby-identifier">edge</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">dist</span> = <span class="ruby-identifier">edge</span>.<span class="ruby-identifier">distance</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
    <span class="ruby-identifier">dist</span> = <span class="ruby-identifier">edge</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">dist</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_edge_distance_string" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_edge_distance_string</span><span
            class="method-args">(edge)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets distance string from the given edge. Returns a string or nil.</p>
          
          

          
          <div class="method-source-code" id="get_edge_distance_string-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 111</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_edge_distance_string</span>(<span class="ruby-identifier">edge</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">dist</span> = <span class="ruby-identifier">edge</span>.<span class="ruby-identifier">distance_string</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
    <span class="ruby-identifier">dist</span> = (<span class="ruby-identifier">edge</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">edge</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">dist</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_edge_merged" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_edge_merged</span><span
            class="method-args">(edge1, edge2)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns edge1 + edge2</p>
          
          

          
          <div class="method-source-code" id="get_edge_merged-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 121</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_edge_merged</span>(<span class="ruby-identifier">edge1</span>, <span class="ruby-identifier">edge2</span>)
  <span class="ruby-identifier">dist1</span> = <span class="ruby-identifier">get_edge_distance</span>(<span class="ruby-identifier">edge1</span>)
  <span class="ruby-identifier">dist2</span> = <span class="ruby-identifier">get_edge_distance</span>(<span class="ruby-identifier">edge2</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">dist1</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">dist2</span> <span class="ruby-keyword">then</span>
    <span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">dist1</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">dist2</span>)
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">dist1</span> <span class="ruby-keyword">then</span>
    <span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">dist1</span>)
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">dist2</span> <span class="ruby-keyword">then</span>
    <span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">dist2</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_node_bootstrap" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_node_bootstrap</span><span
            class="method-args">(node)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_node_bootstrap-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 237</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_node_bootstrap</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">node</span>.<span class="ruby-identifier">bootstrap</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_node_bootstrap_string" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_node_bootstrap_string</span><span
            class="method-args">(node)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_node_bootstrap_string-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 245</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_node_bootstrap_string</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">node</span>.<span class="ruby-identifier">bootstrap_string</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_node_by_name" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_node_by_name</span><span
            class="method-args">(str)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Finds a node in the tree by given name and returns the node. If the node
does not found, returns nil. If multiple nodes with the same name exist,
the result would be one of those (unspecified).</p>
          
          

          
          <div class="method-source-code" id="get_node_by_name-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 390</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_node_by_name</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">each_node</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">get_node_name</span>(<span class="ruby-identifier">node</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">str</span>
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">node</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_node_name" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_node_name</span><span
            class="method-args">(node)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets node name</p>
          
          

          
          <div class="method-source-code" id="get_node_name-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 229</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_node_name</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">node</span>.<span class="ruby-identifier">name</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
    <span class="ruby-identifier">node</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-include-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">include?</span><span
            class="method-args">(node)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>If the node exists, returns true. Otherwise, returns false.</p>
          
          

          
          <div class="method-source-code" id="include-3F-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 410</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">include?</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">node</span>] <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-insert_node" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">insert_node</span><span
            class="method-args">(node1, node2, new_node, new_distance = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Insert a new node between adjacent nodes node1 and node2. The old edge
between node1 and node2 are changed to the edge between new_node and node2.
The edge between node1 and new_node is newly created.</p>

<p>If new_distance is specified, the distance between node1 and new_node is
set to new_distance, and distance between new_node and node2 is set to
<code>tree.get_edge(node1, node2).distance - new_distance</code>.</p>

<p>Returns self. If node1 and node2 are not adjacent, raises IndexError.</p>

<p>If new_node already exists in the tree, the tree would become circular. In
addition, if the edge between new_node and node1 (or node2) already exists,
it will be erased.</p>
          
          

          
          <div class="method-source-code" id="insert_node-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 890</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">insert_node</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>, <span class="ruby-identifier">new_node</span>, <span class="ruby-identifier">new_distance</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">edge</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">get_edge</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>) <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">IndexError</span>, <span class="ruby-string">&#39;nodes not found or two nodes are not adjacent&#39;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">_clear_cache</span>
  <span class="ruby-identifier">new_edge</span> = <span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">new_distance</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">remove_edge</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">add_edge</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">new_node</span>, <span class="ruby-identifier">new_edge</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_distance</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">old_distance</span> = <span class="ruby-identifier">get_edge_distance</span>(<span class="ruby-identifier">edge</span>) <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">old_distance</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">new_distance</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">edge</span>.<span class="ruby-identifier">distance</span> = <span class="ruby-identifier">old_distance</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
      <span class="ruby-identifier">edge</span> = <span class="ruby-identifier">old_distance</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">add_edge</span>(<span class="ruby-identifier">new_node</span>, <span class="ruby-identifier">node2</span>, <span class="ruby-identifier">edge</span>)
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-leaves" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">leaves</span><span
            class="method-args">(node = nil, root = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>If <em>node</em> is nil, returns an array of  all leaves (nodes connected
with one edge). Otherwise, gets all descendent leaf nodes of the
<em>node</em>. If <em>root</em> isn&#39;t specified or <em>root</em> is
<code>nil</code>, @root is used. Returns an array of <code>Node</code>s.
The result is unspecified for cyclic trees.</p>
          
          

          
          <div class="method-source-code" id="leaves-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 738</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">leaves</span>(<span class="ruby-identifier">node</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">root</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">node</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">nodes</span> = []
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">each_node</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">nodes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">x</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">out_degree</span>(<span class="ruby-identifier">x</span>) <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">nodes</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">root</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@root</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">descendents</span>(<span class="ruby-identifier">node</span>, <span class="ruby-identifier">root</span>).<span class="ruby-identifier">find_all</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">adjacent_nodes</span>(<span class="ruby-identifier">x</span>).<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-lowest_common_ancestor" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">lowest_common_ancestor</span><span
            class="method-args">(node1, node2, root = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets the lowest common ancestor of the two nodes. If <em>root</em>
isn&#39;t specified or <em>root</em> is <code>nil</code>, @root is used.
Returns a <code>Node</code> object or nil. The result is unspecified for
cyclic trees.</p>
          
          

          
          <div class="method-source-code" id="lowest_common_ancestor-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 766</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">lowest_common_ancestor</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>, <span class="ruby-identifier">root</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">root</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@root</span>
  <span class="ruby-identifier">_</span>, <span class="ruby-identifier">route</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">breadth_first_search</span>(<span class="ruby-identifier">root</span>)
  <span class="ruby-identifier">x</span> = <span class="ruby-identifier">node1</span>; <span class="ruby-identifier">r1</span> = []
  <span class="ruby-keyword">begin</span>; <span class="ruby-identifier">r1</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">x</span>; <span class="ruby-keyword">end</span> <span class="ruby-keyword">while</span> <span class="ruby-identifier">x</span> = <span class="ruby-identifier">route</span>[<span class="ruby-identifier">x</span>]
  <span class="ruby-identifier">x</span> = <span class="ruby-identifier">node2</span>; <span class="ruby-identifier">r2</span> = []
  <span class="ruby-keyword">begin</span>; <span class="ruby-identifier">r2</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">x</span>; <span class="ruby-keyword">end</span> <span class="ruby-keyword">while</span> <span class="ruby-identifier">x</span> = <span class="ruby-identifier">route</span>[<span class="ruby-identifier">x</span>]
  <span class="ruby-keyword">return</span> (<span class="ruby-identifier">r1</span> <span class="ruby-operator">&amp;</span> <span class="ruby-identifier">r2</span>).<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-newick" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">newick</span><span
            class="method-args">(options = {})</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Tree.html#method-i-output_newick">output_newick</a>
        </div>
        
      </div>

    
      <div id="method-i-nodes" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">nodes</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns all nodes as an array.</p>
          
          

          
          <div class="method-source-code" id="nodes-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 295</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">nodes</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>.<span class="ruby-identifier">keys</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-number_of_edges" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">number_of_edges</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns number of edges in the tree.</p>
          
          

          
          <div class="method-source-code" id="number_of_edges-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 326</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">number_of_edges</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">relations</span>.<span class="ruby-identifier">size</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-number_of_nodes" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">number_of_nodes</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Number of nodes.</p>
          
          

          
          <div class="method-source-code" id="number_of_nodes-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 300</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">number_of_nodes</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">nodes</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-out_degree" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">out_degree</span><span
            class="method-args">(source)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns number of edges in the given node.</p>

<p>The reason why the method name is “out_degree” is that it comes from the
Boost Graph Library.</p>
          
          

          
          <div class="method-source-code" id="out_degree-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 365</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">out_degree</span>(<span class="ruby-identifier">source</span>)
  <span class="ruby-identifier">h</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">source</span>]
  <span class="ruby-identifier">h</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">h</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-out_edges" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">out_edges</span><span
            class="method-args">(source)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns all connected edges with adjacent nodes. Returns an array of the
array [ source, target, edge ].</p>

<p>The reason why the method name is “out_edges” is that it comes from the
Boost Graph Library.</p>
          
          

          
          <div class="method-source-code" id="out_edges-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 341</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">out_edges</span>(<span class="ruby-identifier">source</span>)
  <span class="ruby-identifier">h</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">source</span>]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">h</span>
    <span class="ruby-identifier">h</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span> [ <span class="ruby-identifier">source</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span> ] }
  <span class="ruby-keyword">else</span>
    []
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-output" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">output</span><span
            class="method-args">(format, *arg, &amp;block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns formatted text (or something) of the tree Currently supported
format is: :newick, :nhx</p>
          
          

          
          <div class="method-source-code" id="output-source">
            <pre><span class="ruby-comment"># File lib/bio/tree/output.rb, line 230</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">output</span>(<span class="ruby-identifier">format</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">arg</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">format</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:newick</span>
    <span class="ruby-identifier">output_newick</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">arg</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-value">:nhx</span>
    <span class="ruby-identifier">output_nhx</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">arg</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-value">:phylip_distance_matrix</span>
    <span class="ruby-identifier">output_phylip_distance_matrix</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">arg</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-string">&#39;Unknown format&#39;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-output_newick" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">output_newick</span><span
            class="method-args">(options = {}) { |node1, node2| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a newick formatted string. If block is given, the order of the node
is sorted (as the same manner as Enumerable#sort).</p>

<p>Available options:</p>
<dl class="rdoc-list note-list"><dt><code>:indent</code>
<dd>
<p>indent string; set false to disable (default: &#39;  &#39;)</p>
</dd><dt><code>:bootstrap_style</code>
<dd>
<p><code>:disabled</code> disables bootstrap representations.
<code>:traditional</code> for traditional style. <code>:molphy</code> for
Molphy style (default).</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="output_newick-source">
            <pre><span class="ruby-comment"># File lib/bio/tree/output.rb, line 198</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">output_newick</span>(<span class="ruby-identifier">options</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-comment">#:yields: node1, node2</span>
  <span class="ruby-identifier">root</span> = <span class="ruby-ivar">@root</span>
  <span class="ruby-identifier">root</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">first</span>
  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;();&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">root</span>
  <span class="ruby-identifier">__to_newick</span>([], <span class="ruby-identifier">root</span>, <span class="ruby-value">0</span>, <span class="ruby-value">:__to_newick_format_leaf</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-operator">+</span>
    <span class="ruby-identifier">__to_newick_format_leaf</span>(<span class="ruby-identifier">root</span>, <span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>, <span class="ruby-identifier">options</span>) <span class="ruby-operator">+</span>
    <span class="ruby-string">&quot;;\n&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Tree.html#method-i-newick">newick</a>
        </div>
        

        
      </div>

    
      <div id="method-i-output_nhx" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">output_nhx</span><span
            class="method-args">(options = {}) { |node1, node2| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a NHX (New Hampshire eXtended) formatted string. If block is given,
the order of the node is sorted (as the same manner as Enumerable#sort).</p>

<p>Available options:</p>
<dl class="rdoc-list note-list"><dt><code>:indent</code>
<dd>
<p>indent string; set false to disable (default: &#39;  &#39;)</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="output_nhx-source">
            <pre><span class="ruby-comment"># File lib/bio/tree/output.rb, line 218</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">output_nhx</span>(<span class="ruby-identifier">options</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-comment">#:yields: node1, node2</span>
  <span class="ruby-identifier">root</span> = <span class="ruby-ivar">@root</span>
  <span class="ruby-identifier">root</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">first</span>
  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;();&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">root</span>
  <span class="ruby-identifier">__to_newick</span>([], <span class="ruby-identifier">root</span>, <span class="ruby-value">0</span>,
              <span class="ruby-value">:__to_newick_format_leaf_NHX</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-operator">+</span>
    <span class="ruby-identifier">__to_newick_format_leaf_NHX</span>(<span class="ruby-identifier">root</span>, <span class="ruby-constant">Edge</span>.<span class="ruby-identifier">new</span>, <span class="ruby-identifier">options</span>) <span class="ruby-operator">+</span>
    <span class="ruby-string">&quot;;\n&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-output_phylip_distance_matrix" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">output_phylip_distance_matrix</span><span
            class="method-args">(nodes = nil, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Generates phylip-style distance matrix as a string. if nodes is not given,
all leaves in the tree are used. If the names of some of the given (or
default) nodes are not defined or are empty, the names are automatically
generated.</p>
          
          

          
          <div class="method-source-code" id="output_phylip_distance_matrix-source">
            <pre><span class="ruby-comment"># File lib/bio/tree/output.rb, line 251</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">output_phylip_distance_matrix</span>(<span class="ruby-identifier">nodes</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">nodes</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">leaves</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">nodes</span>
  <span class="ruby-identifier">names</span> = <span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">y</span> = <span class="ruby-identifier">get_node_name</span>(<span class="ruby-identifier">x</span>)
    <span class="ruby-identifier">y</span> = <span class="ruby-identifier">sprintf</span>(<span class="ruby-string">&quot;%x&quot;</span>, <span class="ruby-identifier">x</span>.<span class="ruby-identifier">__id__</span>.<span class="ruby-identifier">abs</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">y</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">y</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">m</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">distance_matrix</span>(<span class="ruby-identifier">nodes</span>)
  <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Phylip</span><span class="ruby-operator">::</span><span class="ruby-constant">DistanceMatrix</span>.<span class="ruby-identifier">generate</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">names</span>, <span class="ruby-identifier">options</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parent" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parent</span><span
            class="method-args">(node, root = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets the parent node of the <em>node</em>. If <em>root</em> isn&#39;t
specified or <em>root</em> is <code>nil</code>, @root is used. Returns an
<code>Node</code> object or nil. The result is unspecified for cyclic
trees.</p>
          
          

          
          <div class="method-source-code" id="parent-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 687</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">parent</span>(<span class="ruby-identifier">node</span>, <span class="ruby-identifier">root</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">root</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@root</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">IndexError</span>, <span class="ruby-string">&#39;can not get parent for unrooted tree&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">root</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">_get_cached_parent</span>(<span class="ruby-identifier">node</span>, <span class="ruby-identifier">root</span>) <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">ret</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>(<span class="ruby-identifier">root</span>, <span class="ruby-identifier">node</span>)[<span class="ruby-value">-2</span>]
    <span class="ruby-identifier">_cache_parent</span>(<span class="ruby-identifier">node</span>, <span class="ruby-identifier">ret</span>, <span class="ruby-identifier">root</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">ret</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-path" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">path</span><span
            class="method-args">(node1, node2)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets path from node1 to node2. Retruns an array of nodes, including node1
and node2. If node1 and/or node2 do not exist, IndexError is raised. If
node1 and node2 are not connected, <a
href="Tree/NoPathError.html">NoPathError</a> is raised. The result is
unspecified for cyclic trees.</p>
          
          

          
          <div class="method-source-code" id="path-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 612</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">path</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">IndexError</span>, <span class="ruby-string">&#39;node1 not found&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">node1</span>]
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">IndexError</span>, <span class="ruby-string">&#39;node2 not found&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">node2</span>]
  <span class="ruby-keyword">return</span> [ <span class="ruby-identifier">node1</span> ] <span class="ruby-keyword">if</span> <span class="ruby-identifier">node1</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">node2</span>
  <span class="ruby-keyword">return</span> [ <span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span> ] <span class="ruby-keyword">if</span> <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">node1</span>][<span class="ruby-identifier">node2</span>]
  <span class="ruby-identifier">_</span>, <span class="ruby-identifier">path</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">bfs_shortest_path</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">path</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">node1</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">path</span>[<span class="ruby-value">-1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">node2</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoPathError</span>, <span class="ruby-string">&#39;node1 and node2 are not connected&#39;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">path</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_edge" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_edge</span><span
            class="method-args">(source, target)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p># Removes an edge between source and target. # Returns self. # If the edge
does not exist, raises IndexError. +</p>
          
          

          
          <div class="method-source-code" id="remove_edge-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 465</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_edge</span>(<span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">get_edge</span>(<span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span>) <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">IndexError</span>, <span class="ruby-string">&#39;edge not found&#39;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">_clear_cache</span>
  <span class="ruby-identifier">fwd</span> = [ <span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span> ]
  <span class="ruby-identifier">rev</span> = [ <span class="ruby-identifier">target</span>, <span class="ruby-identifier">source</span> ]
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">relations</span>.<span class="ruby-identifier">delete_if</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rel</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">fwd</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">rev</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">h</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">source</span>]
  <span class="ruby-identifier">h</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">target</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">h</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">target</span>]
  <span class="ruby-identifier">h</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">source</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">h</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_edge_if" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_edge_if</span><span
            class="method-args">() { |source, target, edge| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes each edge if the block returns not nil. Returns self.</p>
          
          

          
          <div class="method-source-code" id="remove_edge_if-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 484</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_edge_if</span> <span class="ruby-comment">#:yields: source, target, edge</span>
  <span class="ruby-identifier">_clear_cache</span>
  <span class="ruby-identifier">removed_rel</span> = []
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">relations</span>.<span class="ruby-identifier">delete_if</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rel</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>[<span class="ruby-value">1</span>], <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">edge</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">removed_rel</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">rel</span>
      <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">removed_rel</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rel</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">source</span> = <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>[<span class="ruby-value">0</span>]
    <span class="ruby-identifier">target</span> = <span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>[<span class="ruby-value">1</span>]
    <span class="ruby-identifier">h</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">source</span>]
    <span class="ruby-identifier">h</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">target</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">h</span>
    <span class="ruby-identifier">h</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">target</span>]
    <span class="ruby-identifier">h</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">source</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">h</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_node" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_node</span><span
            class="method-args">(node)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes the given node from the tree. All edges connected with the node are
also removed. Returns self. If the node does not exist, raises IndexError.</p>
          
          

          
          <div class="method-source-code" id="remove_node-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 436</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_node</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-comment">#_clear_cache #done in clear_node(node)</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">clear_node</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">node</span>)
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_node_if" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_node_if</span><span
            class="method-args">() { |node then clear_node| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes each node if the block returns not nil. All edges connected with
the removed nodes are also removed. Returns self.</p>
          
          

          
          <div class="method-source-code" id="remove_node_if-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 446</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_node_if</span>
  <span class="ruby-comment">#_clear_cache #done in clear_node(node)</span>
  <span class="ruby-identifier">all</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">nodes</span>
  <span class="ruby-identifier">all</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">node</span> <span class="ruby-keyword">then</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">clear_node</span>(<span class="ruby-identifier">node</span>)
      <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">node</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_nonsense_nodes" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_nonsense_nodes</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes all nodes that are not branches nor leaves. That is, removes nodes
connected with exactly two edges. For each removed node, two adjacent edges
are merged and a new edge are created. Returns removed nodes. Note that
orphan nodes are still kept unchanged.</p>
          
          

          
          <div class="method-source-code" id="remove_nonsense_nodes-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 852</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_nonsense_nodes</span>
  <span class="ruby-identifier">_clear_cache</span>
  <span class="ruby-identifier">hash</span> = {}
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">each_node</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">node</span>] = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">node</span>].<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">each_key</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">adjs</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">node</span>].<span class="ruby-identifier">keys</span>
    <span class="ruby-identifier">edges</span> = <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">node</span>].<span class="ruby-identifier">values</span>
    <span class="ruby-identifier">new_edge</span> = <span class="ruby-identifier">get_edge_merged</span>(<span class="ruby-identifier">edges</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">edges</span>[<span class="ruby-value">1</span>])
    <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">adjs</span>[<span class="ruby-value">0</span>]].<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">node</span>)
    <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">adjs</span>[<span class="ruby-value">1</span>]].<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">node</span>)
    <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">node</span>)
    <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">append</span>(<span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">Relation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">adjs</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">adjs</span>[<span class="ruby-value">1</span>], <span class="ruby-identifier">new_edge</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment">#@pathway.to_relations</span>
  <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">relations</span>.<span class="ruby-identifier">reject!</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rel</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>[<span class="ruby-value">0</span>]] <span class="ruby-keyword">or</span> <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">rel</span>.<span class="ruby-identifier">node</span>[<span class="ruby-value">1</span>]]
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">keys</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-subtree" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">subtree</span><span
            class="method-args">(nodes)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets the sub-tree consisted of given nodes. <em>nodes</em> must be an array
of nodes. Nodes that do not exist in the original tree are ignored. Returns
a <a href="Tree.html">Tree</a> object. Note that the sub-tree shares <a
href="Tree/Node.html">Node</a> and <a href="Tree/Edge.html">Edge</a>
objects with the original tree.</p>
          
          

          
          <div class="method-source-code" id="subtree-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 543</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">subtree</span>(<span class="ruby-identifier">nodes</span>)
  <span class="ruby-identifier">nodes</span> = <span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">find_all</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@pathway</span>.<span class="ruby-identifier">graph</span>[<span class="ruby-identifier">x</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-comment"># creates subtree</span>
  <span class="ruby-identifier">new_tree</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">new_tree</span>.<span class="ruby-identifier">add_node</span>(<span class="ruby-identifier">x</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">each_edge</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>, <span class="ruby-identifier">edge</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_tree</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">node1</span>) <span class="ruby-keyword">and</span> <span class="ruby-identifier">new_tree</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">node2</span>) <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">new_tree</span>.<span class="ruby-identifier">add_edge</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>, <span class="ruby-identifier">edge</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">new_tree</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-subtree_with_all_paths" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">subtree_with_all_paths</span><span
            class="method-args">(nodes)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Gets the sub-tree consisted of given nodes and all internal nodes connected
between given nodes. <em>nodes</em> must be an array of nodes. Nodes that
do not exist in the original tree are ignored. Returns a <a
href="Tree.html">Tree</a> object. The result is unspecified for cyclic
trees. Note that the sub-tree shares <a href="Tree/Node.html">Node</a> and
<a href="Tree/Edge.html">Edge</a> objects with the original tree.</p>
          
          

          
          <div class="method-source-code" id="subtree_with_all_paths-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 569</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">subtree_with_all_paths</span>(<span class="ruby-identifier">nodes</span>)
  <span class="ruby-identifier">hash</span> = {}
  <span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">x</span>] = <span class="ruby-keyword">true</span> }
  <span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">each_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">node1</span> = <span class="ruby-identifier">nodes</span>[<span class="ruby-identifier">i</span>]
    (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">i</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">j</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">node2</span> = <span class="ruby-identifier">nodes</span>[<span class="ruby-identifier">j</span>]
      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">node1</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">node2</span> <span class="ruby-keyword">then</span>
        <span class="ruby-keyword">begin</span>
          <span class="ruby-identifier">path</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>(<span class="ruby-identifier">node1</span>, <span class="ruby-identifier">node2</span>)
        <span class="ruby-keyword">rescue</span> <span class="ruby-constant">IndexError</span>, <span class="ruby-constant">NoPathError</span>
          <span class="ruby-identifier">path</span> = []
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">path</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">x</span>] = <span class="ruby-keyword">true</span> }
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">subtree</span>(<span class="ruby-identifier">hash</span>.<span class="ruby-identifier">keys</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-total_distance" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">total_distance</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns total distance of all edges. It would raise error if some edges
didn&#39;t contain distance values.</p>
          
          

          
          <div class="method-source-code" id="total_distance-source">
            <pre><span class="ruby-comment"># File lib/bio/tree.rb, line 778</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">total_distance</span>
  <span class="ruby-identifier">distance</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">each_edge</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span>, <span class="ruby-identifier">edge</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">distance</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">get_edge_distance</span>(<span class="ruby-identifier">edge</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">distance</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.0.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

