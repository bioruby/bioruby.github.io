<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Bio::SOFT - BioRuby API documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#class-Bio::SOFT-label-Description">Description</a>
    <li><a href="#class-Bio::SOFT-label-Usage">Usage</a>
  </ul>
</div>


  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="../Object.html">Object</a>
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-custom_raise">#custom_raise</a>
    
    <li ><a href="#method-i-error_msg">#error_msg</a>
    
    <li ><a href="#method-i-process">#process</a>
    
    <li ><a href="#method-i-split_label_value_in">#split_label_value_in</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Bio::SOFT">
  <h1 id="class-Bio::SOFT" class="class">
    class Bio::SOFT
  </h1>

  <section class="description">
    
<p>bio/db/soft.rb - Interface for <a href="SOFT.html">SOFT</a> formatted files</p>
<dl class="rdoc-list note-list"><dt>Author
<dd>
<p>Trevor Wennblom  &lt;<a
href="mailto:trevor@corevx.com">trevor@corevx.com</a>&gt;</p>
</dd><dt>Copyright
<dd>
<p>Copyright © 2007 Midwinter Laboratories, LLC (<a
href="http://midwinterlabs.com">midwinterlabs.com</a>)</p>
</dd><dt>License
<dd>
<p>The Ruby License</p>
</dd></dl>

<h1 id="class-Bio::SOFT-label-Description">Description<span><a href="#class-Bio::SOFT-label-Description">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>“SOFT (Simple Omnibus in Text Format) is a compact, simple, line-based, 
ASCII text format that incorporates experimental data and metadata.” –
<em>GEO, National Center for Biotechnology Information</em></p>

<p>The <a href="SOFT.html">Bio::SOFT</a> module reads <a
href="SOFT.html">SOFT</a> Series or Platform formatted files that  contain
information describing one database, one series, one platform, and many
samples (GEO accessions).  The data from the file can then be viewed with
Ruby methods.</p>

<p><a href="SOFT.html">Bio::SOFT</a> also supports the reading of <a
href="SOFT.html">SOFT</a> DataSet files which contain one database, one
dataset, and many subsets.</p>

<p>Format specification is located here:</p>
<ul><li>
<p><a
href="http://www.ncbi.nlm.nih.gov/projects/geo/info/soft2.html#SOFTformat">www.ncbi.nlm.nih.gov/projects/geo/info/soft2.html#SOFTformat</a></p>
</li></ul>

<p><a href="SOFT.html">SOFT</a> data files may be directly downloaded here:</p>
<ul><li>
<p><a
href="ftp://ftp.ncbi.nih.gov/pub/geo/DATA/SOFT">ftp.ncbi.nih.gov/pub/geo/DATA/SOFT</a></p>
</li></ul>

<p>NCBI&#39;s Gene Expression Omnibus (GEO) is here:</p>
<ul><li>
<p><a href="http://www.ncbi.nlm.nih.gov/geo">www.ncbi.nlm.nih.gov/geo</a></p>
</li></ul>

<h1 id="class-Bio::SOFT-label-Usage">Usage<span><a href="#class-Bio::SOFT-label-Usage">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>If an attribute has more than one value then the values are stored in an
Array of String objects.  Otherwise the attribute is stored as a String.</p>

<p>The platform and each sample may contain a table of data.  A dataset from a
DataSet file may also contain a table.</p>

<p>Attributes are dynamically created based on the data in the file.
Predefined keys have not been created in advance due to the variability of
<a href="SOFT.html">SOFT</a> files in-the-wild.</p>

<p>Keys are generally stored as Symbols.  In the case of keys for samples and
table headings may alternatively be accessed with Strings. The names of
samples (geo accessions) are case sensitive.  Table headers  are case
insensitive.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;bio&#39;</span>

<span class="ruby-identifier">lines</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">readlines</span>(<span class="ruby-string">&#39;GSE3457_family.soft&#39;</span>) 
<span class="ruby-identifier">soft</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">SOFT</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">lines</span>)

<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>[<span class="ruby-value">:geo_accession</span>]             <span class="ruby-comment"># =&gt; &quot;GPL2092&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>[<span class="ruby-value">:organism</span>]                  <span class="ruby-comment"># =&gt; &quot;Populus&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>[<span class="ruby-value">:contributor</span>]               <span class="ruby-comment"># =&gt; [&quot;Jingyi,,Li&quot;, &quot;Olga,,Shevchenko&quot;, &quot;Steve,H,Strauss&quot;, &quot;Amy,M,Brunner&quot;]</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>[<span class="ruby-value">:data_row_count</span>]            <span class="ruby-comment"># =&gt; &quot;240&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">b</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">b</span>.<span class="ruby-identifier">to_s</span>}[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">2</span>] <span class="ruby-comment"># =&gt; [:contact_address, :contact_city, :contact_country]</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>[<span class="ruby-value">:&quot;contact_zip/postal_code&quot;</span>] <span class="ruby-comment"># =&gt; &quot;97331&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">header</span>              <span class="ruby-comment"># =&gt; [&quot;ID&quot;, &quot;GB_ACC&quot;, &quot;SPOT_ID&quot;, &quot;Function/Family&quot;, &quot;ORGANISM&quot;, &quot;SEQUENCE&quot;]</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">header_description</span>  <span class="ruby-comment"># =&gt; {&quot;ORGANISM&quot;=&gt;&quot;sequence sources&quot;, &quot;SEQUENCE&quot;=&gt;&quot;oligo sequence used&quot;, &quot;Function/Family&quot;=&gt;&quot;gene functions and family&quot;, &quot;ID&quot;=&gt;&quot;&quot;, &quot;SPOT_ID&quot;=&gt;&quot;&quot;, &quot;GB_ACC&quot;=&gt;&quot;Gene bank accession number&quot;}</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>.<span class="ruby-identifier">size</span>           <span class="ruby-comment"># =&gt; 240</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>]             <span class="ruby-comment"># =&gt; [&quot;A039P68U&quot;, &quot;AI163321&quot;, &quot;&quot;, &quot;TF, flowering protein CONSTANS&quot;, &quot;P. tremula x P. tremuloides&quot;, &quot;AGAAAATTCGATATACTGTCCGTAAAGAGGTAGCACTTAGAATGCAACGGAATAAAGGGCAGTTCACCTC&quot;]</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>][<span class="ruby-value">4</span>]          <span class="ruby-comment"># =&gt; &quot;P. tremula x P. tremuloides&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>][<span class="ruby-value">:organism</span>]  <span class="ruby-comment"># =&gt; &quot;P. tremula x P. tremuloides&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">platform</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>][<span class="ruby-string">&#39;ORGANISM&#39;</span>] <span class="ruby-comment"># =&gt; &quot;P. tremula x P. tremuloides&quot;</span>

<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">series</span>[<span class="ruby-value">:geo_accession</span>]               <span class="ruby-comment"># =&gt; &quot;GSE3457&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">series</span>[<span class="ruby-value">:contributor</span>]                 <span class="ruby-comment"># =&gt; [&quot;Jingyi,,Li&quot;, &quot;Olga,,Shevchenko&quot;, &quot;Ove,,Nilsson&quot;, &quot;Steve,H,Strauss&quot;, &quot;Amy,M,Brunner&quot;]</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">series</span>[<span class="ruby-value">:platform_id</span>]                 <span class="ruby-comment"># =&gt; &quot;GPL2092&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">series</span>[<span class="ruby-value">:sample_id</span>].<span class="ruby-identifier">size</span>              <span class="ruby-comment"># =&gt; 74</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">series</span>[<span class="ruby-value">:sample_id</span>][<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">4</span>]             <span class="ruby-comment"># =&gt; [&quot;GSM77557&quot;, &quot;GSM77558&quot;, &quot;GSM77559&quot;, &quot;GSM77560&quot;, &quot;GSM77561&quot;]</span>

<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">database</span>[<span class="ruby-value">:name</span>]                      <span class="ruby-comment"># =&gt; &quot;Gene Expression Omnibus (GEO)&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">database</span>[<span class="ruby-value">:ref</span>]                       <span class="ruby-comment"># =&gt; &quot;Nucleic Acids Res. 2005 Jan 1;33 Database Issue:D562-6&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">database</span>[<span class="ruby-value">:institute</span>]                 <span class="ruby-comment"># =&gt; &quot;NCBI NLM NIH&quot;</span>

<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>.<span class="ruby-identifier">size</span>                         <span class="ruby-comment"># =&gt; 74</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>[<span class="ruby-value">:GSM77600</span>][<span class="ruby-value">:series_id</span>]       <span class="ruby-comment"># =&gt; &quot;GSE3457&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>[<span class="ruby-string">&#39;GSM77600&#39;</span>][<span class="ruby-value">:series_id</span>]      <span class="ruby-comment"># =&gt; &quot;GSE3457&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>[<span class="ruby-value">:GSM77600</span>][<span class="ruby-value">:platform_id</span>]     <span class="ruby-comment"># =&gt; &quot;GPL2092&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>[<span class="ruby-value">:GSM77600</span>][<span class="ruby-value">:type</span>]            <span class="ruby-comment"># =&gt; &quot;RNA&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>[<span class="ruby-value">:GSM77600</span>][<span class="ruby-value">:title</span>]           <span class="ruby-comment"># =&gt; &quot;jst2b2&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>[<span class="ruby-value">:GSM77600</span>][<span class="ruby-value">:table</span>].<span class="ruby-identifier">header</span>    <span class="ruby-comment"># =&gt; [&quot;ID_REF&quot;, &quot;VALUE&quot;]</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>[<span class="ruby-value">:GSM77600</span>][<span class="ruby-value">:table</span>].<span class="ruby-identifier">header_description</span> <span class="ruby-comment"># =&gt; {&quot;ID_REF&quot;=&gt;&quot;&quot;, &quot;VALUE&quot;=&gt;&quot;normalized signal intensities&quot;}</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>[<span class="ruby-value">:GSM77600</span>][<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>.<span class="ruby-identifier">size</span> <span class="ruby-comment"># =&gt; 217</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>[<span class="ruby-value">:GSM77600</span>][<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>]   <span class="ruby-comment"># =&gt; [&quot;A039P68U&quot;, &quot;8.19&quot;]</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>[<span class="ruby-value">:GSM77600</span>][<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>][<span class="ruby-value">0</span>]        <span class="ruby-comment"># =&gt; &quot;A039P68U&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>[<span class="ruby-value">:GSM77600</span>][<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>][<span class="ruby-value">:id_ref</span>]  <span class="ruby-comment"># =&gt; &quot;A039P68U&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">samples</span>[<span class="ruby-value">:GSM77600</span>][<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>][<span class="ruby-string">&#39;ID_REF&#39;</span>] <span class="ruby-comment"># =&gt; &quot;A039P68U&quot;</span>

<span class="ruby-identifier">lines</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">readlines</span>(<span class="ruby-string">&#39;GDS100.soft&#39;</span>) 
<span class="ruby-identifier">soft</span> = <span class="ruby-constant">Bio</span><span class="ruby-operator">::</span><span class="ruby-constant">SOFT</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">lines</span>)

<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">database</span>[<span class="ruby-value">:name</span>]                      <span class="ruby-comment"># =&gt; &quot;Gene Expression Omnibus (GEO)&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">database</span>[<span class="ruby-value">:ref</span>]                       <span class="ruby-comment"># =&gt; &quot;Nucleic Acids Res. 2005 Jan 1;33 Database Issue:D562-6&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">database</span>[<span class="ruby-value">:institute</span>]                 <span class="ruby-comment"># =&gt; &quot;NCBI NLM NIH&quot;</span>

<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">subsets</span>.<span class="ruby-identifier">size</span>                         <span class="ruby-comment"># =&gt; 8</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">subsets</span>.<span class="ruby-identifier">keys</span>                         <span class="ruby-comment"># =&gt; [&quot;GDS100_1&quot;, &quot;GDS100_2&quot;, &quot;GDS100_3&quot;, &quot;GDS100_4&quot;, &quot;GDS100_5&quot;, &quot;GDS100_6&quot;, &quot;GDS100_7&quot;, &quot;GDS100_8&quot;]</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">subsets</span>[<span class="ruby-value">:GDS100_7</span>]                   <span class="ruby-comment"># =&gt; {:dataset_id=&gt;&quot;GDS100&quot;, :type=&gt;&quot;time&quot;, :sample_id=&gt;&quot;GSM548,GSM543&quot;, :description=&gt;&quot;60 minute&quot;}</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">subsets</span>[<span class="ruby-string">&#39;GDS100_7&#39;</span>][<span class="ruby-value">:sample_id</span>]      <span class="ruby-comment"># =&gt; &quot;GSM548,GSM543&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">subsets</span>[<span class="ruby-value">:GDS100_7</span>][<span class="ruby-value">:sample_id</span>]       <span class="ruby-comment"># =&gt; &quot;GSM548,GSM543&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">subsets</span>[<span class="ruby-value">:GDS100_7</span>][<span class="ruby-value">:dataset_id</span>]      <span class="ruby-comment"># =&gt; &quot;GDS100&quot;</span>

<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">dataset</span>[<span class="ruby-value">:order</span>]                      <span class="ruby-comment"># =&gt; &quot;none&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">dataset</span>[<span class="ruby-value">:sample_organism</span>]            <span class="ruby-comment"># =&gt; &quot;Escherichia coli&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">dataset</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">header</span>               <span class="ruby-comment"># =&gt; [&quot;ID_REF&quot;, &quot;IDENTIFIER&quot;, &quot;GSM549&quot;, &quot;GSM542&quot;, &quot;GSM543&quot;, &quot;GSM547&quot;, &quot;GSM544&quot;, &quot;GSM545&quot;, &quot;GSM546&quot;, &quot;GSM548&quot;]</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">dataset</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>.<span class="ruby-identifier">size</span>            <span class="ruby-comment"># =&gt; 5764</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">dataset</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>]              <span class="ruby-comment"># =&gt; [&quot;6&quot;, &quot;EMPTY&quot;, &quot;0.097&quot;, &quot;0.217&quot;, &quot;0.242&quot;, &quot;0.067&quot;, &quot;0.104&quot;, &quot;0.162&quot;, &quot;0.104&quot;, &quot;0.154&quot;]</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">dataset</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>][<span class="ruby-value">4</span>]           <span class="ruby-comment"># =&gt; &quot;0.242&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">dataset</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>][<span class="ruby-value">:gsm549</span>]     <span class="ruby-comment"># =&gt; &quot;0.097&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">dataset</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>][<span class="ruby-value">:GSM549</span>]     <span class="ruby-comment"># =&gt; &quot;0.097&quot;</span>
<span class="ruby-identifier">soft</span>.<span class="ruby-identifier">dataset</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">rows</span>[<span class="ruby-value">5</span>][<span class="ruby-string">&#39;GSM549&#39;</span>]    <span class="ruby-comment"># =&gt; &quot;0.097&quot;</span>
</pre>

  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="LINE_TYPE_ENTITY_ATTRIBUTE">LINE_TYPE_ENTITY_ATTRIBUTE
        
        <dd>
        
      
        <dt id="LINE_TYPE_ENTITY_INDICATOR">LINE_TYPE_ENTITY_INDICATOR
        
        <dd>
        
      
        <dt id="LINE_TYPE_TABLE_HEADER">LINE_TYPE_TABLE_HEADER
        
        <dd>
        
      
        <dt id="TABLE_COLUMN_DELIMITER">TABLE_COLUMN_DELIMITER
        
        <dd><p>data table row defined by absence of line type character</p>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-database" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">database</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-dataset" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">dataset</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-platform" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">platform</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-samples" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">samples</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-series" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">series</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-subsets" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">subsets</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(lines=nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Constructor</p>
<hr>

<p><strong>Arguments</strong></p>
<ul><li>
<p><code>lines</code>: (<em>required</em>) contents of <a
href="SOFT.html">SOFT</a> formatted file</p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p><a href="SOFT.html">Bio::SOFT</a></p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/bio/db/soft.rb, line 147</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">lines</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-ivar">@database</span> = <span class="ruby-constant">Database</span>.<span class="ruby-identifier">new</span>
  
  <span class="ruby-ivar">@series</span> = <span class="ruby-constant">Series</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@platform</span> = <span class="ruby-constant">Platform</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@samples</span> = <span class="ruby-constant">Samples</span>.<span class="ruby-identifier">new</span>
  
  <span class="ruby-ivar">@dataset</span> = <span class="ruby-constant">Dataset</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@subsets</span> = <span class="ruby-constant">Subsets</span>.<span class="ruby-identifier">new</span>
  
  <span class="ruby-identifier">process</span>(<span class="ruby-identifier">lines</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="protected-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Protected Instance Methods</h3>
       </header>

    
      <div id="method-i-custom_raise" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">custom_raise</span><span
            class="method-args">( line_number_with_0_based_indexing, msg )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="custom_raise-source">
            <pre><span class="ruby-comment"># File lib/bio/db/soft.rb, line 381</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">custom_raise</span>( <span class="ruby-identifier">line_number_with_0_based_indexing</span>, <span class="ruby-identifier">msg</span> )
  <span class="ruby-identifier">raise</span> [<span class="ruby-node">&quot;Error processing input line: #{line_number_with_0_based_indexing+1}&quot;</span>,
    <span class="ruby-identifier">msg</span>].<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\t&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-error_msg" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">error_msg</span><span
            class="method-args">( i, extra_info=nil )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="error_msg-source">
            <pre><span class="ruby-comment"># File lib/bio/db/soft.rb, line 354</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">error_msg</span>( <span class="ruby-identifier">i</span>, <span class="ruby-identifier">extra_info</span>=<span class="ruby-keyword">nil</span> )
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">i</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">10</span>
    <span class="ruby-identifier">x</span> = [<span class="ruby-string">&quot;Lines without line-type characters are rows in a table, but&quot;</span>,
    <span class="ruby-string">&quot;a line containing an entity indicator such as&quot;</span>,
    <span class="ruby-node">&quot;\&quot;#{LINE_TYPE_ENTITY_INDICATOR}SAMPLE\&quot;,&quot;</span>,
    <span class="ruby-node">&quot;\&quot;#{LINE_TYPE_ENTITY_INDICATOR}PLATFORM\&quot;,&quot;</span>,
    <span class="ruby-node">&quot;or \&quot;#{LINE_TYPE_ENTITY_INDICATOR}DATASET\&quot; has not been&quot;</span>,
    <span class="ruby-string">&quot;previously encountered or it does not appear that this line is&quot;</span>,
    <span class="ruby-string">&quot;in a table.&quot;</span>]
  <span class="ruby-keyword">when</span> <span class="ruby-value">20</span>
    <span class="ruby-comment"># tables are allowed inside samples and platforms</span>
    <span class="ruby-identifier">x</span> = [<span class="ruby-string">&quot;Tables are only allowed inside SAMPLE and PLATFORM.&quot;</span>,
      <span class="ruby-node">&quot;Current table information found inside #{extra_info}.&quot;</span>]
  <span class="ruby-keyword">when</span> <span class="ruby-value">30</span>
    <span class="ruby-identifier">x</span> = [<span class="ruby-node">&quot;Entity attribute line (\&quot;#{LINE_TYPE_ENTITY_ATTRIBUTE}\&quot;)&quot;</span>,
      <span class="ruby-node">&quot;found before entity indicator line (\&quot;#{LINE_TYPE_ENTITY_INDICATOR}\&quot;)&quot;</span>]
  <span class="ruby-keyword">when</span> <span class="ruby-value">40</span>
    <span class="ruby-identifier">x</span> = [<span class="ruby-string">&quot;Unkown entity indicator.  Must be DATABASE, SAMPLE, PLATFORM,&quot;</span>,
      <span class="ruby-string">&quot;SERIES, DATASET, or SUBSET.&quot;</span>]
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">IndexError</span>, <span class="ruby-string">&quot;Unknown error message requested.&quot;</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-identifier">x</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-process" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">process</span><span
            class="method-args">(lines)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="process-source">
            <pre><span class="ruby-comment"># File lib/bio/db/soft.rb, line 272</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">process</span>(<span class="ruby-identifier">lines</span>)
  <span class="ruby-identifier">current_indicator</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">current_class_accessor</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">in_table</span> = <span class="ruby-keyword">false</span>
      
  <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span>, <span class="ruby-identifier">line_number</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">line</span>.<span class="ruby-identifier">strip!</span>
    <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">line</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">line</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">line</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">chr</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">LINE_TYPE_ENTITY_INDICATOR</span>
      <span class="ruby-identifier">current_indicator</span>, <span class="ruby-identifier">value</span> = <span class="ruby-identifier">split_label_value_in</span>( <span class="ruby-identifier">line</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] )

      <span class="ruby-keyword">case</span> <span class="ruby-identifier">current_indicator</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;DATABASE&#39;</span>
        <span class="ruby-identifier">current_class_accessor</span> = <span class="ruby-ivar">@database</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;DATASET&#39;</span>
        <span class="ruby-identifier">current_class_accessor</span> = <span class="ruby-ivar">@dataset</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;PLATFORM&#39;</span>
        <span class="ruby-identifier">current_class_accessor</span> = <span class="ruby-ivar">@platform</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;SERIES&#39;</span>
        <span class="ruby-identifier">current_class_accessor</span> = <span class="ruby-ivar">@series</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;SAMPLE&#39;</span>
        <span class="ruby-ivar">@samples</span>[<span class="ruby-identifier">value</span>] = <span class="ruby-constant">Sample</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">current_class_accessor</span> = <span class="ruby-ivar">@samples</span>[<span class="ruby-identifier">value</span>]
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;SUBSET&#39;</span>
        <span class="ruby-ivar">@subsets</span>[<span class="ruby-identifier">value</span>] = <span class="ruby-constant">Subset</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-identifier">current_class_accessor</span> = <span class="ruby-ivar">@subsets</span>[<span class="ruby-identifier">value</span>]
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">custom_raise</span>( <span class="ruby-identifier">line_number</span>, <span class="ruby-identifier">error_msg</span>(<span class="ruby-value">40</span>, <span class="ruby-identifier">line</span>) )
      <span class="ruby-keyword">end</span>
        
    <span class="ruby-keyword">when</span> <span class="ruby-constant">LINE_TYPE_ENTITY_ATTRIBUTE</span>
      <span class="ruby-keyword">if</span>( <span class="ruby-identifier">current_indicator</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span> )
        <span class="ruby-identifier">custom_raise</span>( <span class="ruby-identifier">line_number</span>, <span class="ruby-identifier">error_msg</span>(<span class="ruby-value">30</span>) )
      <span class="ruby-keyword">end</span>
      
      <span class="ruby-comment"># Handle lines such as &#39;!platform_table_begin&#39; and &#39;!platform_table_end&#39;</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">in_table</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r{table_begin}</span>
          <span class="ruby-keyword">next</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r{table_end}</span>
          <span class="ruby-identifier">in_table</span> = <span class="ruby-keyword">false</span>
          <span class="ruby-keyword">next</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
      
      <span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span> = <span class="ruby-identifier">split_label_value_in</span>( <span class="ruby-identifier">line</span>, <span class="ruby-keyword">true</span> )
      <span class="ruby-identifier">key_s</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_sym</span>
      
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_class_accessor</span>.<span class="ruby-identifier">include?</span>( <span class="ruby-identifier">key_s</span> )
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_class_accessor</span>[ <span class="ruby-identifier">key_s</span> ].<span class="ruby-identifier">class</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">Array</span>
          <span class="ruby-identifier">current_class_accessor</span>[ <span class="ruby-identifier">key_s</span> ] = [ <span class="ruby-identifier">current_class_accessor</span>[ <span class="ruby-identifier">key_s</span> ] ]
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">current_class_accessor</span>[<span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_sym</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">current_class_accessor</span>[<span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">value</span>
      <span class="ruby-keyword">end</span>
      
    <span class="ruby-keyword">when</span> <span class="ruby-constant">LINE_TYPE_TABLE_HEADER</span>
      <span class="ruby-keyword">if</span>( (<span class="ruby-identifier">current_indicator</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;SAMPLE&#39;</span>) <span class="ruby-keyword">and</span> (<span class="ruby-identifier">current_indicator</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;PLATFORM&#39;</span>) <span class="ruby-keyword">and</span> (<span class="ruby-identifier">current_indicator</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;DATASET&#39;</span>) )
        <span class="ruby-identifier">custom_raise</span>( <span class="ruby-identifier">line_number</span>, <span class="ruby-identifier">error_msg</span>(<span class="ruby-value">20</span>, <span class="ruby-identifier">current_indicator</span>.<span class="ruby-identifier">inspect</span>) )
      <span class="ruby-keyword">end</span>
      
      <span class="ruby-identifier">in_table</span> = <span class="ruby-keyword">true</span>   <span class="ruby-comment"># may be redundant, computationally not worth checking</span>

      <span class="ruby-comment"># We only expect one table per platform or sample</span>
      <span class="ruby-identifier">current_class_accessor</span>[<span class="ruby-value">:table</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">Table</span>.<span class="ruby-identifier">new</span>
      <span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span> = <span class="ruby-identifier">split_label_value_in</span>( <span class="ruby-identifier">line</span> )
      <span class="ruby-comment"># key[1..-1] -- Remove first character which is the LINE_TYPE_TABLE_HEADER</span>
      <span class="ruby-identifier">current_class_accessor</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">header_description</span>[ <span class="ruby-identifier">key</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] ] = <span class="ruby-identifier">value</span>
      
    <span class="ruby-keyword">else</span>
      <span class="ruby-comment"># Type: No line type - should be a row in a table.</span>
      
      <span class="ruby-keyword">if</span>( (<span class="ruby-identifier">current_indicator</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>) <span class="ruby-keyword">or</span> (<span class="ruby-identifier">in_table</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>) )
        <span class="ruby-identifier">custom_raise</span>( <span class="ruby-identifier">line_number</span>, <span class="ruby-identifier">error_msg</span>(<span class="ruby-value">10</span>) )
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">current_class_accessor</span>[<span class="ruby-value">:table</span>].<span class="ruby-identifier">add_header_or_row</span>( <span class="ruby-identifier">line</span> )
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-split_label_value_in" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">split_label_value_in</span><span
            class="method-args">( line, shift_key=false )</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="split_label_value_in-source">
            <pre><span class="ruby-comment"># File lib/bio/db/soft.rb, line 386</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">split_label_value_in</span>( <span class="ruby-identifier">line</span>, <span class="ruby-identifier">shift_key</span>=<span class="ruby-keyword">false</span> )
  <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r{\s*=\s*}</span>
  <span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span> = <span class="ruby-node">$`</span>, <span class="ruby-node">$&#39;</span>
  
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">shift_key</span>
    <span class="ruby-identifier">key</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r{_}</span>
    <span class="ruby-identifier">key</span> = <span class="ruby-node">$&#39;</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-keyword">if</span>( (<span class="ruby-identifier">key</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>) <span class="ruby-keyword">or</span> (<span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>) )
    <span class="ruby-identifier">puts</span> <span class="ruby-identifier">line</span>.<span class="ruby-identifier">inspect</span>
    <span class="ruby-identifier">raise</span>
  <span class="ruby-keyword">end</span>
  
  [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.0.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

