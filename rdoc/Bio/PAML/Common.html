<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Bio::PAML::Common - BioRuby API documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
  var index_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="../../Object.html">Object</a>
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-dump_parameters">#dump_parameters</a>
    
    <li ><a href="#method-i-load_parameters">#load_parameters</a>
    
    <li ><a href="#method-i-query">#query</a>
    
    <li ><a href="#method-i-query_by_string">#query_by_string</a>
    
    <li ><a href="#method-i-run">#run</a>
    
    <li ><a href="#method-i-set_default_parameters">#set_default_parameters</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Bio::PAML::Common">
  <h1 id="class-Bio::PAML::Common" class="class">
    class Bio::PAML::Common
  </h1>

  <section class="description">
    
<h2 id="class-Bio::PAML::Common-label-Description">Description<span><a href="#class-Bio::PAML::Common-label-Description">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p><a href="Common.html">Bio::PAML::Common</a> is a basic wrapper class for <a
href="../PAML.html">PAML</a> programs.  The class provides methods for
generating the necessary configuration  file, and running a program.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="DEFAULT_PARAMETERS">DEFAULT_PARAMETERS
        
        <dd><p>Default parameters. Should be redefined in subclass.</p>
        
      
        <dt id="DEFAULT_PARAMETERS_ORDER">DEFAULT_PARAMETERS_ORDER
        
        <dd><p>Preferred order of parameters.</p>
        
      
        <dt id="DEFAULT_PROGRAM">DEFAULT_PROGRAM
        
        <dd><p>Default program. Should be redifined in subclass.</p>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-command" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">command</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>the last executed command (Array of <a href="../../String.html">String</a>)</p>
        
        </div>
      </div>
      
      <div id="attribute-i-data_stdout" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">data_stdout</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>the last output to the stdout (String)</p>
        
        </div>
      </div>
      
      <div id="attribute-i-exit_status" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">exit_status</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>the last exit status of the program</p>
        
        </div>
      </div>
      
      <div id="attribute-i-output" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">output</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>the last result of the program (String)</p>
        
        </div>
      </div>
      
      <div id="attribute-i-parameters" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">parameters</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Parameters described in the control file. (Hash) Each key of the hash must
be a Symbol object, and each value must be a <a
href="../../String.html">String</a> object or nil.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-report" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">report</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p><a href="Common/Report.html">Report</a> object created from the last result</p>
        
        </div>
      </div>
      
      <div id="attribute-i-supplemental_outputs" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">supplemental_outputs</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>contents of supplemental output files (Hash). Each key is a file name and
value is content of the file.</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(program = nil, params = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates a wrapper instance, which will run using the specified binary
location or the command in the PATH. If program is specified as nil, <a
href="Common.html#DEFAULT_PROGRAM">DEFAULT_PROGRAM</a> is used. Default
parameters are automatically loaded and merged with the specified
parameters.</p>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p>(optional) <em>program</em>: path to the program, or command name (String)</p>
</li><li>
<p>(optional) <em>params</em>: parameters (Hash)</p>
</li></ul>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/paml/common.rb, line 73</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">program</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">params</span> = {})
  <span class="ruby-ivar">@program</span> = <span class="ruby-identifier">program</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT_PROGRAM</span>
  <span class="ruby-identifier">set_default_parameters</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parameters</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">params</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-dump_parameters" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dump_parameters</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Shows parameters (content of control file) as a string. The string can be
used for control file.</p>
<hr>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>string representation of the parameters (String)</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="dump_parameters-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/paml/common.rb, line 270</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dump_parameters</span>
  <span class="ruby-identifier">keyorder</span> = <span class="ruby-constant">DEFAULT_PARAMETERS_ORDER</span>
  <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">parameters</span>.<span class="ruby-identifier">keys</span>
  <span class="ruby-identifier">str</span> = <span class="ruby-string">&#39;&#39;</span>
  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span><span class="ruby-operator">|</span>
    (<span class="ruby-identifier">keyorder</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">x</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">keyorder</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">x</span>))) <span class="ruby-operator">&lt;=&gt;</span>
      (<span class="ruby-identifier">keyorder</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">y</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">keyorder</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">y</span>)))
  <span class="ruby-keyword">end</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">value</span> = <span class="ruby-identifier">parameters</span>[<span class="ruby-identifier">key</span>]
    <span class="ruby-comment"># Note: spaces are required in both side of the &quot;=&quot;.</span>
    <span class="ruby-identifier">str</span>.<span class="ruby-identifier">concat</span> <span class="ruby-node">&quot;#{key.to_s} = #{value.to_s}\n&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">str</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-load_parameters" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load_parameters</span><span
            class="method-args">(str)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Loads parameters from the specified string. Note that all previous
parameters are erased. Returns the parameters as a hash.</p>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p>(required) <em>str</em>: contents of a <a href="../PAML.html">PAML</a>
control file (String)</p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>parameters (Hash)</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="load_parameters-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/paml/common.rb, line 248</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_parameters</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-identifier">hash</span> = {}
  <span class="ruby-identifier">str</span>.<span class="ruby-identifier">each_line</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">param</span>, <span class="ruby-identifier">value</span> = <span class="ruby-identifier">parse_parameter</span>(<span class="ruby-identifier">line</span>)
    <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">param</span>] = <span class="ruby-identifier">value</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">param</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parameters</span> = <span class="ruby-identifier">hash</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-query" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">query</span><span
            class="method-args">(alignment, tree = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Runs the program on the internal parameters with the specified sequence
alignment and tree.</p>

<p>Note that <a href=":seqfile">parameters</a> and <a
href=":outfile">parameters</a> are always modified, and <a
href=":treefile">parameters</a> is modified when tree is specified.</p>

<p>To prevent overwrite of existing files by <a href="../PAML.html">PAML</a>,
this method automatically creates a temporary directory and the program is
run inside the directory. After the end of the program, the temporary
directory is automatically removed.</p>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p>(required) <em>alignment</em>: <a
href="../Alignment.html">Bio::Alignment</a> object or similar object</p>
</li><li>
<p>(optional) <em>tree</em>: <a href="../Tree.html">Bio::Tree</a> object</p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p><a href="Common/Report.html">Report</a> object</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="query-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/paml/common.rb, line 117</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">query</span>(<span class="ruby-identifier">alignment</span>, <span class="ruby-identifier">tree</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">astr</span> = <span class="ruby-identifier">alignment</span>.<span class="ruby-identifier">output</span>(<span class="ruby-value">:phylipnon</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">tree</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">tstr</span> = [ <span class="ruby-identifier">sprintf</span>(<span class="ruby-string">&quot;%3d %2d\n&quot;</span>, <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">leaves</span>.<span class="ruby-identifier">size</span>, <span class="ruby-value">1</span>), <span class="ruby-string">&quot;\n&quot;</span>,
             <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">output</span>(<span class="ruby-value">:newick</span>,
                         { <span class="ruby-value">:indent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>,
                           <span class="ruby-value">:bootstrap_style</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:disabled</span>,
                           <span class="ruby-value">:branch_length_style</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:disabled</span> })
           ].<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39;&#39;</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">tstr</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">str</span> = <span class="ruby-identifier">_query_by_string</span>(<span class="ruby-identifier">astr</span>, <span class="ruby-identifier">tstr</span>)
  <span class="ruby-ivar">@report</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">Report</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-ivar">@report</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-query_by_string" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">query_by_string</span><span
            class="method-args">(alignment = nil, tree = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Runs the program on the internal parameters with the specified sequence
alignment data string and tree data string.</p>

<p>Note that <a href=":outfile">parameters</a> is always modified, and <a
href=":seqfile">parameters</a> and <a href=":treefile">parameters</a> are
modified when alignment and tree are specified respectively.</p>

<p>It raises RuntimeError if seqfile is not specified in the argument or in
the parameter.</p>

<p>For other information, see the document of query method.</p>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p>(optional) <em>alignment</em>: <a href="../../String.html">String</a></p>
</li><li>
<p>(optional) <em>tree</em>: <a href="../../String.html">String</a> or nil</p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>contents of output file (String)</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="query_by_string-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/paml/common.rb, line 151</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">query_by_string</span>(<span class="ruby-identifier">alignment</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">tree</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">_query_by_string</span>(<span class="ruby-identifier">alignment</span>, <span class="ruby-identifier">tree</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-run" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">run</span><span
            class="method-args">(control_file)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Runs the program on the parameters in the passed control file. No
parameters checks are performed. All internal parameters are ignored and
are kept untouched. The output and report attributes are cleared in this
method.</p>

<p>Warning about PAML&#39;s behavior: <a href="../PAML.html">PAML</a> writes
supplemental output files in the current directory with fixed file names
which can not be changed with parameters or command-line options, for
example, rates, rst, and rub. This behavior may ovarwrite existing files,
especially previous supplemental results.</p>
<hr>

<p><strong>Arguments</strong>:</p>
<ul><li>
<p>(optional) <em>control_file</em>: file name of control file (String)</p>
</li></ul>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>messages printed to the standard output (String)</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="run-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/paml/common.rb, line 95</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">run</span>(<span class="ruby-identifier">control_file</span>)
  <span class="ruby-identifier">exec_local</span>([ <span class="ruby-identifier">control_file</span> ])
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_default_parameters" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_default_parameters</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Loads system-wide default parameters. Note that all previous parameters are
erased. Returns the parameters as a hash.</p>
<hr>
<dl class="rdoc-list note-list"><dt><strong>Returns</strong>
<dd>
<p>parameters (Hash)</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="set_default_parameters-source">
            <pre><span class="ruby-comment"># File lib/bio/appl/paml/common.rb, line 262</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_default_parameters</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parameters</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT_PARAMETERS</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.0.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

